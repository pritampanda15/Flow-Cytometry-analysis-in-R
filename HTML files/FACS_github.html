<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Pritam Kumar Panda">
<meta name="institution" content="German Cancer Research Center DKFZ">
<meta name="country" content="Germany">
<title>Flow Cytometry Data Analysis in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="FACS_files/libs/clipboard/clipboard.min.js"></script>
<script src="FACS_files/libs/quarto-html/quarto.js"></script>
<script src="FACS_files/libs/quarto-html/popper.min.js"></script>
<script src="FACS_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="FACS_files/libs/quarto-html/anchor.min.js"></script>
<link href="FACS_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="FACS_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="FACS_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="FACS_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="FACS_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script src="FACS_files/libs/kePrint-0.0.1/kePrint.js"></script><link href="FACS_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Flow Cytometry Data Analysis in R</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pritam Kumar Panda </p>
          </div>
  </div>
    
  
    
  </div>
  

</header><section id="section" class="level2"><h2 class="anchored" data-anchor-id="section"></h2>
</section><section id="high-throughput-facs-analyses-with-r" class="level1"><h1>High-throughput FACS analyses with R</h1>
<p>Evaluating flow cytometry data using R might appear intimidating initially, but I strongly encourage its adoption for individuals conducting medium to high-throughput FACS-based experiments. Even when examining a limited number of markers, conventional flow analysis software such as FlowJo struggles when dealing with extensive sample datasets. It operates slowly, is susceptible to crashes, and exporting large plots can be cumbersome. In contrast, R-based flow cytometry analysis excels in addressing these challenges effectively. Various R packages are available for the analysis of flow cytometry data, offering versatile solutions for researchers.</p>
<p><img src="images/flow_cytometry.png" class="img-fluid"></p>
<p>The packages I am using in this tutorial and which I highly recommend are:</p>
<ol type="1">
<li>flowCore</li>
<li>flowStats</li>
<li>flowAI</li>
<li>cytoML</li>
<li>openCyto</li>
<li>flowWorkspace</li>
<li>ggcyto</li>
</ol>
<p>Other helpful links for parameters: <a href="https://fcsexpressdownloads.s3.amazonaws.com/manual/manual_WIN_RUO/index.html?welcome_to_fcs_express_version.htm" class="uri">https://fcsexpressdownloads.s3.amazonaws.com/manual/manual_WIN_RUO/index.html?welcome_to_fcs_express_version.htm</a></p>
<p><strong>CytoRSuite</strong>&nbsp;is designed to provide an interactive interface for the analysis of flow cytometry data in R. If you are new to&nbsp;<strong>CytoRSuite</strong>&nbsp;visit&nbsp;<a href="https://dillonhammill.github.io/CytoRSuite/" class="uri">https://dillonhammill.github.io/CytoRSuite/</a>&nbsp;to get started.</p>
<div class="cell" data-hash="FACS_cache/html/base packages_c85f4dc36ec0e8add68d77687b16c351">
<details><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"knitr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"kableExtra"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="FACS_cache/html/Install bioconductor packages_883461330a79810c3a38832f882be9f0">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/">"BiocManager"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html">install</a></span><span class="op">(</span><span class="st">"flowCore"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Bioconductor version 3.18 (BiocManager 1.30.22), R 4.3.2 (2023-10-31)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package(s) not installed when version(s) same as or greater than current; use
  `force = TRUE` to re-install: 'flowCore'</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html">install</a></span><span class="op">(</span><span class="st">"flowWorkspace"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Bioconductor version 3.18 (BiocManager 1.30.22), R 4.3.2 (2023-10-31)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package(s) not installed when version(s) same as or greater than current; use
  `force = TRUE` to re-install: 'flowWorkspace'</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html">install</a></span><span class="op">(</span><span class="st">"openCyto"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Bioconductor version 3.18 (BiocManager 1.30.22), R 4.3.2 (2023-10-31)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package(s) not installed when version(s) same as or greater than current; use
  `force = TRUE` to re-install: 'openCyto'</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html">install</a></span><span class="op">(</span><span class="st">"flowAI"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Bioconductor version 3.18 (BiocManager 1.30.22), R 4.3.2 (2023-10-31)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package(s) not installed when version(s) same as or greater than current; use
  `force = TRUE` to re-install: 'flowAI'</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html">install</a></span><span class="op">(</span><span class="st">"ggcyto"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Bioconductor version 3.18 (BiocManager 1.30.22), R 4.3.2 (2023-10-31)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package(s) not installed when version(s) same as or greater than current; use
  `force = TRUE` to re-install: 'ggcyto'</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html">install</a></span><span class="op">(</span><span class="st">"CytoML"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Bioconductor version 3.18 (BiocManager 1.30.22), R 4.3.2 (2023-10-31)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package(s) not installed when version(s) same as or greater than current; use
  `force = TRUE` to re-install: 'CytoML'</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#optional package to explore further</span></span>
<span><span class="co"># CytoExploreR </span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"DillonHammill/CytoExploreR"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Skipping install of 'CytoExploreR' from a github remote, the SHA1 (0efb1cc1) has not changed since last install.
  Use `force = TRUE` to force installation</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"DillonHammill/CytoExploreRData"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Skipping install of 'CytoExploreRData' from a github remote, the SHA1 (488edf08) has not changed since last install.
  Use `force = TRUE` to force installation</code></pre>
</div>
</div>
<div class="cell" data-hash="FACS_cache/html/load-packages_42b65f0ee0bc7bf053838394a8b9ea38">
<details><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">flowCore</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RGLab/CytoML">CytoML</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">flowAI</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">flowWorkspace</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>As part of improvements to flowWorkspace, some behavior of
GatingSet objects has changed. For details, please read the section
titled "The cytoframe and cytoset classes" in the package vignette:

  vignette("flowWorkspace-Introduction", "flowWorkspace")</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RGLab/ggcyto/issues">ggcyto</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ncdfFlow</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: BH</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.3     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ ggcyto::%+%()   masks ggplot2::%+%()
✖ dplyr::filter() masks ncdfFlow::filter(), flowCore::filter(), stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DillonHammill/CytoExploreR">CytoExploreR</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Loading required package: openCyto</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">openCyto</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CytoExploreRData</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'

The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="FACS_cache/html/increase memory and use cache of larger files_6d5d5a9f420cdcb197cc339545c6f204">
<details><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span>, warning <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                      message <span class="op">=</span> <span class="cn">FALSE</span>, cache.lazy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="format-.fcs-data" class="level2"><h2 class="anchored" data-anchor-id="format-.fcs-data">Format .fcs data</h2>
<p>Before running the analyses, do this to rename all your files using this bash script to add “_” if the file name has spaces.</p>
<div class="cell" data-hash="FACS_cache/html/format your files_f5c282219b6db0cd63ce06e1c6998bfe">
<details><summary>Code</summary><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> facs_data</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> file <span class="kw">in</span> Specimen_<span class="pp">*</span>.fcs<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mv</span> <span class="st">"</span><span class="va">$file</span><span class="st">"</span> <span class="st">"</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$file</span> <span class="kw">|</span> <span class="fu">tr</span> <span class="st">' '</span> <span class="st">'_'</span><span class="va">)</span><span class="st">"</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>If you want to load only one sample and get to know the details you can do so by using read.FCS function.</p>
<div class="cell" data-hash="FACS_cache/html/read single file_efed664314166a61fab59c2328c6aa2e">
<details><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Read one single dataset</span></span>
<span><span class="co">#myfile &lt;- "./facs_data/Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs"</span></span>
<span><span class="co">#fcsfile&lt;- read.FCS(myfile, truncate_max_range = FALSE)</span></span>
<span><span class="co">#names(fcsfile)#names of the columns</span></span>
<span><span class="co">#exprs(fcsfile) #expression values</span></span>
<span><span class="co">#each_col(fcsfile, median) #median</span></span>
<span><span class="co">#keyword(fcsfile) #metadata</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="read-the-whole-dataset" class="level2"><h2 class="anchored" data-anchor-id="read-the-whole-dataset">Read the whole dataset</h2>
<p>The&nbsp;<code>read.flowSet</code>&nbsp;allows you to read many&nbsp;<code>.fcs</code>&nbsp;at once. The resultant flowSet object will store the data from all these&nbsp;<code>.fcs</code>&nbsp;files.</p>
<div class="cell" data-hash="FACS_cache/html/read the whole dataset_4c0bd6004f78ca9b88945bfee94de494">
<details><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#check the coloumn names</span></span>
<span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/read.flowSet.html">read.flowSet</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"./facs_data//"</span>, pattern <span class="op">=</span> <span class="st">".fcs"</span>, truncate_max_range <span class="op">=</span> <span class="cn">FALSE</span>, alter.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">fs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>A flowSet with 1 experiments.

column names(33): FSC.A FSC.H ... PE.A Time</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>A flowSet with 5 experiments.

column names(33): FSC.A FSC.H ... PE.A Time</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">fs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "FSC.A"      "FSC.H"      "SSC.A"      "SSC.H"      "BB515.A"   
 [6] "BB630.A"    "BB660.P.A"  "BB700.A"    "BB755.P.A"  "BB790.P.A" 
[11] "BUV395.A"   "BUV496.A"   "BUV563.A"   "BUV615.A"   "BUV661.A"  
[16] "BUV737.A"   "BUV805.A"   "BV421.A"    "BV510.A"    "BV570.A"   
[21] "BV605.A"    "BV650.A"    "BV711.A"    "BV750.A"    "BV786.A"   
[26] "APC.A"      "APC.R700.A" "APC.H7.A"   "PE.CF594.A" "PE.Cy5.A"  
[31] "PE.Cy7.A"   "PE.A"       "Time"      </code></pre>
</div>
</div>
<p>#Sample information such as sample names can be accessed with the&nbsp;pData&nbsp;function. So, let’s extract the well ID from the sample name.</p>
<div class="cell" data-hash="FACS_cache/html/extract metadata_89408a9f57c9f48dface695816aef2e7">
<details><summary>Code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html">pData</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs"
[2] "Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs"     
[3] "Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs"    
[4] "Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs"     
[5] "Specimen_001_MS_01_NF_HC_del_18-10-21.fcs"        </code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Pattern to extract the date, accounting for potential extra text after the date</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html">pData</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span><span class="op">$</span><span class="va">well</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">".*del_(\\d{1,2}-\\d{1,2}-\\d{2,4}).*?\\.fcs"</span>, <span class="st">"\\1"</span>, <span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureNames.html">sampleNames</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html">pData</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                                                                                               name
Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs
Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs           Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs
Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs         Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs
Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs           Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs
Specimen_001_MS_01_NF_HC_del_18-10-21.fcs                 Specimen_001_MS_01_NF_HC_del_18-10-21.fcs
                                                      well
Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs 17-10-22
Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs      07-12-22
Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs     30-03-22
Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs      25-03-22
Specimen_001_MS_01_NF_HC_del_18-10-21.fcs         18-10-21</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">### Understand the abbrebiations/dyes/chemicals used. This is optional</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "FSC.A"      "FSC.H"      "SSC.A"      "SSC.H"      "BB515.A"   
 [6] "BB630.A"    "BB660.P.A"  "BB700.A"    "BB755.P.A"  "BB790.P.A" 
[11] "BUV395.A"   "BUV496.A"   "BUV563.A"   "BUV615.A"   "BUV661.A"  
[16] "BUV737.A"   "BUV805.A"   "BV421.A"    "BV510.A"    "BV570.A"   
[21] "BV605.A"    "BV650.A"    "BV711.A"    "BV750.A"    "BV786.A"   
[26] "APC.A"      "APC.R700.A" "APC.H7.A"   "PE.CF594.A" "PE.Cy5.A"  
[31] "PE.Cy7.A"   "PE.A"       "Time"      </code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#check parameters data</span></span>
<span><span class="va">fs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">parameters</span><span class="op">@</span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           name   desc  range minRange maxRange
$P1       FSC.A   &lt;NA&gt; 262144     -111   262143
$P2       FSC.H   &lt;NA&gt; 262144        0   262143
$P3       SSC.A   &lt;NA&gt; 262144     -111   262143
$P4       SSC.H   &lt;NA&gt; 262144        0   262143
$P5     BB515.A   CD24 262144     -111   262143
$P6     BB630.A    IgD 262144     -111   262143
$P7   BB660.P.A   CD56 262144     -111   262143
$P8     BB700.A   CD38 262144     -111   262143
$P9   BB755.P.A  CD275 262144     -111   262143
$P10  BB790.P.A   CD16 262144     -111   262143
$P11   BUV395.A   CD45 262144     -111   262143
$P12   BUV496.A    CD3 262144     -111   262143
$P13   BUV563.A CD45RA 262144     -111   262143
$P14   BUV615.A   CD19 262144     -111   262143
$P15   BUV661.A  CD11c 262144     -111   262143
$P16   BUV737.A    CD4 262144     -111   262143
$P17   BUV805.A    CD8 262144     -111   262143
$P18    BV421.A  CD278 262144     -111   262143
$P19    BV510.A  CD196 262144     -111   262143
$P20    BV570.A   CD27 262144     -111   262143
$P21    BV605.A HLA-DR 262144     -111   262143
$P22    BV650.A   CD28 262144     -111   262143
$P23    BV711.A   CCR7 262144     -111   262143
$P24    BV750.A   CD20 262144     -111   262143
$P25    BV786.A  CD127 262144     -111   262143
$P26      APC.A  CXCR3 262144     -111   262143
$P27 APC.R700.A   CD25 262144     -111   262143
$P28   APC.H7.A FVS780 262144     -111   262143
$P29 PE.CF594.A  CD194 262144     -111   262143
$P30   PE.Cy5.A  CD123 262144     -111   262143
$P31   PE.Cy7.A CD45RO 262144     -111   262143
$P32       PE.A   CD14 262144     -111   262143
$P33       Time   &lt;NA&gt; 262144        0   262143</code></pre>
</div>
</div>
<section id="abbreviations-used" class="level4"><h4 class="anchored" data-anchor-id="abbreviations-used">Abbreviations used</h4>
<p>The abbreviations are commonly used in flow cytometry. Here’s a brief explanation of some of the key terms:</p>
<ol type="1">
<li>
<p><strong>FSC</strong>: Forward Scatter</p>
<ul>
<li>
<strong>FSC.A</strong>: Forward Scatter Area</li>
<li>
<strong>FSC.H</strong>: Forward Scatter Height</li>
</ul>
<p>Forward scatter is related to the size of the cell. The larger the cell, the more light is scattered in the forward direction.</p>
</li>
<li>
<p><strong>SSC</strong>: Side Scatter</p>
<ul>
<li>
<strong>SSC.A</strong>: Side Scatter Area</li>
<li>
<strong>SSC.H</strong>: Side Scatter Height</li>
</ul>
<p>Side scatter reflects the complexity or granularity of the cell. For example, cells with internal structures, like granules, will scatter more light to the side.</p>
</li>
<li>
<p><strong>FITC</strong>: Fluorescein Isothiocyanate</p>
<ul>
<li>This is a fluorescent dye used to label cells or components within cells. It’s not explicitly listed in your abbreviations, but it’s a common fluorochrome in flow cytometry.</li>
</ul>
</li>
<li><p>The other abbreviations (like “BB515.A”, “BB630.A”, “BUV395.A”, etc.) are likely referring to specific fluorescent markers or dyes used in the analysis. Each of these markers is designed to bind to a specific cell component or molecule and will emit light at a specific wavelength when excited by a laser. The “.A” typically stands for Area, indicating the measurement of the fluorescent signal’s area.</p></li>
<li>
<p><strong>APC</strong>: Allophycocyanin</p>
<ul>
<li>
<strong>APC.A</strong>: Allophycocyanin Area</li>
<li>
<strong>APC.R700.A</strong>: APC R700 Area</li>
<li>
<strong>APC.H7.A</strong>: APC H7 Area</li>
</ul>
<p>APC is another fluorescent dye used in flow cytometry.</p>
</li>
<li>
<p><strong>PE</strong>: Phycoerythrin</p>
<ul>
<li>
<strong>PE.CF594.A</strong>: Phycoerythrin CF594 Area</li>
<li>
<strong>PE.Cy5.A</strong>: Phycoerythrin Cy5 Area</li>
<li>
<strong>PE.Cy7.A</strong>: Phycoerythrin Cy7 Area</li>
<li>
<strong>PE.A</strong>: Phycoerythrin Area</li>
</ul>
<p>PE is a bright fluorescent dye commonly used in flow cytometry.</p>
</li>
<li>
<p><strong>BV</strong>: Brilliant Violet</p>
<ul>
<li>The numbers following “BV” (like in “BV421.A”, “BV510.A”, etc.) refer to different variants of the Brilliant Violet dye, each with a specific emission spectrum.</li>
</ul>
</li>
<li><p><strong>Time</strong>: This usually refers to the time parameter, indicating the duration of the cell’s passage through the laser beam, which can be useful for identifying doublets or aggregates.</p></li>
</ol>
<p>Each of these parameters provides different information about the cells being analyzed, allowing for detailed characterization of cell populations based on size, granularity, and the presence of specific markers or dyes.</p>
<div class="cell" data-hash="FACS_cache/html/renaming some markers_e3caa17623a479adefba41cbc46d6a37">
<details><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "FSC.A"      "FSC.H"      "SSC.A"      "SSC.H"      "BB515.A"   
 [6] "BB630.A"    "BB660.P.A"  "BB700.A"    "BB755.P.A"  "BB790.P.A" 
[11] "BUV395.A"   "BUV496.A"   "BUV563.A"   "BUV615.A"   "BUV661.A"  
[16] "BUV737.A"   "BUV805.A"   "BV421.A"    "BV510.A"    "BV570.A"   
[21] "BV605.A"    "BV650.A"    "BV711.A"    "BV750.A"    "BV786.A"   
[26] "APC.A"      "APC.R700.A" "APC.H7.A"   "PE.CF594.A" "PE.Cy5.A"  
[31] "PE.Cy7.A"   "PE.A"       "Time"      </code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">parameters</span><span class="op">@</span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           name   desc  range minRange maxRange
$P1       FSC.A   &lt;NA&gt; 262144     -111   262143
$P2       FSC.H   &lt;NA&gt; 262144        0   262143
$P3       SSC.A   &lt;NA&gt; 262144     -111   262143
$P4       SSC.H   &lt;NA&gt; 262144        0   262143
$P5     BB515.A   CD24 262144     -111   262143
$P6     BB630.A    IgD 262144     -111   262143
$P7   BB660.P.A   CD56 262144     -111   262143
$P8     BB700.A   CD38 262144     -111   262143
$P9   BB755.P.A  CD275 262144     -111   262143
$P10  BB790.P.A   CD16 262144     -111   262143
$P11   BUV395.A   CD45 262144     -111   262143
$P12   BUV496.A    CD3 262144     -111   262143
$P13   BUV563.A CD45RA 262144     -111   262143
$P14   BUV615.A   CD19 262144     -111   262143
$P15   BUV661.A  CD11c 262144     -111   262143
$P16   BUV737.A    CD4 262144     -111   262143
$P17   BUV805.A    CD8 262144     -111   262143
$P18    BV421.A  CD278 262144     -111   262143
$P19    BV510.A  CD196 262144     -111   262143
$P20    BV570.A   CD27 262144     -111   262143
$P21    BV605.A HLA-DR 262144     -111   262143
$P22    BV650.A   CD28 262144     -111   262143
$P23    BV711.A   CCR7 262144     -111   262143
$P24    BV750.A   CD20 262144     -111   262143
$P25    BV786.A  CD127 262144     -111   262143
$P26      APC.A  CXCR3 262144     -111   262143
$P27 APC.R700.A   CD25 262144     -111   262143
$P28   APC.H7.A FVS780 262144     -111   262143
$P29 PE.CF594.A  CD194 262144     -111   262143
$P30   PE.Cy5.A  CD123 262144     -111   262143
$P31   PE.Cy7.A CD45RO 262144     -111   262143
$P32       PE.A   CD14 262144     -111   262143
$P33       Time   &lt;NA&gt; 262144        0   262143</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#If you want to change certain namings then use this. Just an example. You can change accordingly for your observations/experiment</span></span>
<span><span class="co">#colnames(fs)[colnames(fs) == "BB660.P.A"] &lt;- "BB660.P"</span></span>
<span><span class="co">#colnames(fs)[colnames(fs) == "BB755.P.A"] &lt;- "BB755.P"</span></span>
<span><span class="co">#colnames(fs)[colnames(fs) == "BB790.P.A"] &lt;- "BB790.P"</span></span>
<span></span>
<span><span class="co">#If you want to change certain namings then use this</span></span>
<span><span class="co">#colnames(fs)[colnames(fs)=="FSC.A"] &lt;- "FSC"</span></span>
<span><span class="co">#colnames(fs)[colnames(fs)=="PE.CF594.A"] &lt;- "Phycoerythrin"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="compensate-your-sample-manually" class="level2"><h2 class="anchored" data-anchor-id="compensate-your-sample-manually">Compensate your sample manually</h2>
<p>The&nbsp;<strong>Spillover Spreading Matrix</strong>&nbsp;(SSM) values have been demonstrated to reveal fluorescence spectrum interactions that can limit the sensitivity of a reagent in the presence of brightly-stained cells on a different color. The SSM can thus be a useful tool in instrument quality control to ensure consistent sensitivity and performance. In addition, the SSM is a key element for predicting multicolor immunofluorescence panels, which will aid in the optimization and development of new panels.</p>
<p>TheSpillover Spreading Matrix&nbsp;page is automatically created by FCS Express when either the Compensation or the Unmixing Matrix is calculated and depicts a spreadsheet with the Spillover Spreading values for every pair of dyes included in the compensation/unmixing matrix respectively.</p>
<p>Compensating flow cytometry data is an essential step in the analysis of multicolor panels. It corrects for the overlap of fluorescent signals between different channels. The output you provided looks like it’s from an FCS file, showing various parameters like forward scatter (FSC), side scatter (SSC), and different fluorochromes associated with specific markers (e.g., CD24, IgD, CD56).</p>
<p>To properly compensate your FCS files, you typically need the following:</p>
<ol type="1">
<li><p><strong>Unstained Control:</strong> A sample that has cells (or beads) without any fluorescent labels. This control helps you set the baseline for autofluorescence.</p></li>
<li><p><strong>Single-Color Controls:</strong> These are samples where each cell (or bead) is stained with only one fluorochrome at a time. These controls are crucial for compensation as they show the extent of spectral overlap into other channels.</p></li>
<li><p><strong>Compensation Software or Tools:</strong> Most flow cytometry software comes with built-in compensation tools. These tools use the single-color controls to calculate compensation matrices, which are then applied to your experimental data.</p></li>
<li><p><strong>Experimental Data:</strong> Your actual samples that have been stained with multiple fluorochromes.</p></li>
</ol>
<div class="cell" data-hash="FACS_cache/html/compensation using control sample_2772c966df7c52ff081ad37370be96a0">
<details><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#compensate using 1st sample assuming you know the control</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">spillover</a></span><span class="op">(</span><span class="va">fs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fs_comp</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/compensation-class.html">compensate</a></span><span class="op">(</span><span class="va">fs</span>, <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">spillover</a></span><span class="op">(</span><span class="va">fs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">SPILL</span><span class="op">)</span></span>
<span><span class="va">fs_comp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">parameters</span><span class="op">@</span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="quality-check" class="level2"><h2 class="anchored" data-anchor-id="quality-check">Quality check</h2>
<p>It will create a folder with quality control html files.</p>
<ol type="1">
<li>
<p><strong>Flow Rate Check (33.3% of anomalous cells detected):</strong></p>
<ul>
<li><p>This check assesses whether cells are passing through the flow cytometer at an appropriate rate. An optimal flow rate is crucial for accurate data collection.</p></li>
<li><p>Anomalies here could be due to issues like clumping of cells, clogging in the flow cell, or incorrect flow rate settings, leading to inconsistent cell counts or data.</p></li>
<li><p>A high percentage of anomalous cells in this check suggests that a significant portion of the sample may have been analyzed under suboptimal flow conditions.</p></li>
</ul>
</li>
<li>
<p><strong>Signal Acquisition Check (31.05% of anomalous cells detected):</strong></p>
<ul>
<li><p>This pertains to the detection and measurement of the fluorescence and scatter signals from the cells.</p></li>
<li><p>Anomalies in signal acquisition can arise from issues like inadequate staining, photobleaching, detector malfunction, or electronic noise.</p></li>
<li><p>A substantial proportion of cells with anomalous signal acquisition can lead to inaccurate fluorescence intensity measurements, affecting the interpretation of the data.</p></li>
</ul>
</li>
<li>
<p><strong>Dynamic Range Check (49.95% of anomalous cells detected):</strong></p>
<ul>
<li><p>The dynamic range check evaluates whether the fluorescence intensities of the cells fall within the detectable range of the cytometer.</p></li>
<li><p>Cells outside this range can either be too dim (below detection limit) or too bright (causing signal saturation), both of which can skew data interpretation.</p></li>
<li><p>A high percentage in this category could mean that a large portion of your cells are either too dim or too bright for accurate measurement, possibly due to over- or under-staining, or issues with the cytometer settings.</p></li>
</ul>
</li>
</ol>
<div class="cell" data-hash="FACS_cache/html/Quality Check of samples_41788e9e79fbf6182633848aef7efb57">
<details><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#QC</span></span>
<span><span class="co">#flow_auto_qc(fs_comp)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="transformation" class="level2"><h2 class="anchored" data-anchor-id="transformation">Transformation</h2>
<p>Transforming flow cytometry data after compensation is a common and important step in the analysis process. Compensation corrects for spectral overlap between different fluorochromes, but it doesn’t address the issue of data distribution. Flow cytometry data, especially fluorescence intensity, often exhibits a positively skewed distribution. Transformations like log or biexponential (logicle) are used to convert this skewed data into a more normally distributed form, which is easier to analyze and interpret.</p>
<div class="cell" data-hash="FACS_cache/html/transformation_31b99cdbc27743c7348a1067e60ae0a5">
<details><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Transformation</span></span>
<span><span class="va">fs_comp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">parameters</span><span class="op">@</span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           name   desc  range minRange maxRange
$P1       FSC.A   &lt;NA&gt; 262144     -111   262143
$P2       FSC.H   &lt;NA&gt; 262144        0   262143
$P3       SSC.A   &lt;NA&gt; 262144     -111   262143
$P4       SSC.H   &lt;NA&gt; 262144        0   262143
$P5     BB515.A   CD24 262144     -111   262143
$P6     BB630.A    IgD 262144     -111   262143
$P7   BB660.P.A   CD56 262144     -111   262143
$P8     BB700.A   CD38 262144     -111   262143
$P9   BB755.P.A  CD275 262144     -111   262143
$P10  BB790.P.A   CD16 262144     -111   262143
$P11   BUV395.A   CD45 262144     -111   262143
$P12   BUV496.A    CD3 262144     -111   262143
$P13   BUV563.A CD45RA 262144     -111   262143
$P14   BUV615.A   CD19 262144     -111   262143
$P15   BUV661.A  CD11c 262144     -111   262143
$P16   BUV737.A    CD4 262144     -111   262143
$P17   BUV805.A    CD8 262144     -111   262143
$P18    BV421.A  CD278 262144     -111   262143
$P19    BV510.A  CD196 262144     -111   262143
$P20    BV570.A   CD27 262144     -111   262143
$P21    BV605.A HLA-DR 262144     -111   262143
$P22    BV650.A   CD28 262144     -111   262143
$P23    BV711.A   CCR7 262144     -111   262143
$P24    BV750.A   CD20 262144     -111   262143
$P25    BV786.A  CD127 262144     -111   262143
$P26      APC.A  CXCR3 262144     -111   262143
$P27 APC.R700.A   CD25 262144     -111   262143
$P28   APC.H7.A FVS780 262144     -111   262143
$P29 PE.CF594.A  CD194 262144     -111   262143
$P30   PE.Cy5.A  CD123 262144     -111   262143
$P31   PE.Cy7.A CD45RO 262144     -111   262143
$P32       PE.A   CD14 262144     -111   262143
$P33       Time   &lt;NA&gt; 262144        0   262143</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/logicleTransform.html">estimateLogicle</a></span><span class="op">(</span><span class="va">fs_comp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">fs_comp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">5</span><span class="op">:</span><span class="fl">32</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fs_comp_clean_trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/transform.html">transform</a></span><span class="op">(</span><span class="va">fs_comp</span>, <span class="va">trans</span><span class="op">)</span></span>
<span><span class="va">fs_comp_clean_trans</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>flowFrame object 'Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs'
with 2143038 cells and 33 observables:
           name   desc     range     minRange  maxRange
$P1       FSC.A     NA    262144 -111.0000000  262143.0
$P2       FSC.H     NA    262144    0.0000000  262143.0
$P3       SSC.A     NA    262144 -111.0000000  262143.0
$P4       SSC.H     NA    262144    0.0000000  262143.0
$P5     BB515.A   CD24    262144   -0.0397801       4.5
...         ...    ...       ...          ...       ...
$P29 PE.CF594.A  CD194    262144     1.176683       4.5
$P30   PE.Cy5.A  CD123    262144     0.882818       4.5
$P31   PE.Cy7.A CD45RO    262144     0.247081       4.5
$P32       PE.A   CD14    262144     0.162070       4.5
$P33       Time     NA    262144     0.000000  262143.0
454 keywords are stored in the 'description' slot</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fs_comp_clean_trans</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">parameters</span><span class="op">@</span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           name   desc  range      minRange maxRange
$P1       FSC.A   &lt;NA&gt; 262144 -111.00000000 262143.0
$P2       FSC.H   &lt;NA&gt; 262144    0.00000000 262143.0
$P3       SSC.A   &lt;NA&gt; 262144 -111.00000000 262143.0
$P4       SSC.H   &lt;NA&gt; 262144    0.00000000 262143.0
$P5     BB515.A   CD24 262144   -0.03978014      4.5
$P6     BB630.A    IgD 262144    0.52157186      4.5
$P7   BB660.P.A   CD56 262144    0.38536432      4.5
$P8     BB700.A   CD38 262144    1.29049251      4.5
$P9   BB755.P.A  CD275 262144    0.62608445      4.5
$P10  BB790.P.A   CD16 262144    0.56751040      4.5
$P11   BUV395.A   CD45 262144    1.71756616      4.5
$P12   BUV496.A    CD3 262144    0.57168858      4.5
$P13   BUV563.A CD45RA 262144    0.79959312      4.5
$P14   BUV615.A   CD19 262144    0.42488033      4.5
$P15   BUV661.A  CD11c 262144    0.67631571      4.5
$P16   BUV737.A    CD4 262144    0.59027050      4.5
$P17   BUV805.A    CD8 262144    0.32664728      4.5
$P18    BV421.A  CD278 262144    0.66617889      4.5
$P19    BV510.A  CD196 262144    0.47089654      4.5
$P20    BV570.A   CD27 262144    0.60660363      4.5
$P21    BV605.A HLA-DR 262144    0.77251225      4.5
$P22    BV650.A   CD28 262144    0.93755623      4.5
$P23    BV711.A   CCR7 262144    0.98240696      4.5
$P24    BV750.A   CD20 262144    0.95994996      4.5
$P25    BV786.A  CD127 262144    1.01735736      4.5
$P26      APC.A  CXCR3 262144    0.51628511      4.5
$P27 APC.R700.A   CD25 262144    1.04948191      4.5
$P28   APC.H7.A FVS780 262144    1.34052461      4.5
$P29 PE.CF594.A  CD194 262144    1.17668290      4.5
$P30   PE.Cy5.A  CD123 262144    0.88281808      4.5
$P31   PE.Cy7.A CD45RO 262144    0.24708065      4.5
$P32       PE.A   CD14 262144    0.16206998      4.5
$P33       Time   &lt;NA&gt; 262144    0.00000000 262143.0</code></pre>
</div>
</div>
</section><section id="visulaize-the-results-using-ggcyto" class="level2"><h2 class="anchored" data-anchor-id="visulaize-the-results-using-ggcyto">Visulaize the results using ggcyto</h2>
<div class="cell" data-hash="FACS_cache/html/compare the plots_c77bb9f77b576cf7a69b0862d1e777ca">
<details><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">fs_comp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use "none" instead as
of ggplot2 3.3.4.
ℹ The deprecated feature was likely used in the ggcyto package.
  Please report the issue to the authors.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FACS_files/figure-html/compare%20the%20plots-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">fs_comp_clean_trans</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="FACS_files/figure-html/compare%20the%20plots-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">fs_comp</span>, x<span class="op">=</span><span class="st">"FSC.A"</span>, y<span class="op">=</span><span class="st">"SSC.A"</span>, bins <span class="op">=</span> <span class="fl">256</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">well</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="FACS_files/figure-html/compare%20the%20plots-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#visualization with other marker</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">fs_comp_clean_trans</span>, x<span class="op">=</span><span class="st">"FSC.A"</span>, y<span class="op">=</span><span class="st">"PE.CF594.A"</span>, bins <span class="op">=</span> <span class="fl">256</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">well</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="FACS_files/figure-html/compare%20the%20plots-4.png" class="img-fluid" width="672"></p>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#visualization with time</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">fs_comp_clean_trans</span>, x<span class="op">=</span><span class="st">"Time"</span>, y<span class="op">=</span><span class="st">"FSC.A"</span>, bins <span class="op">=</span> <span class="fl">256</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">well</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="FACS_files/figure-html/compare%20the%20plots-5.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="gatingset" class="level2"><h2 class="anchored" data-anchor-id="gatingset">GatingSet</h2>
<section id="what-is-gating-in-flow-cytometry" class="level3"><h3 class="anchored" data-anchor-id="what-is-gating-in-flow-cytometry"><strong>What is Gating in Flow Cytometry?</strong></h3>
<ol type="1">
<li><p><strong>Cell Population Identification</strong>: Gating is used to identify and isolate specific subpopulations of cells from a heterogeneous mixture. Flow cytometry can analyze thousands to millions of cells in a single run, and these cells can vary in size, granularity, and fluorescence. Gating allows researchers to focus on specific cells of interest based on these characteristics.</p></li>
<li><p><strong>Noise Reduction</strong>: It helps in eliminating debris, dead cells, and aggregates, which are not relevant to the analysis. This cleaning up of data is crucial for accurate results.</p></li>
<li><p><strong>Analysis Simplification</strong>: By isolating specific cell populations, gating simplifies the analysis. It’s easier to study and interpret the characteristics of a homogenous population than a heterogeneous one.</p></li>
<li><p><strong>Quantitative Analysis</strong>: Gating enables quantitative analysis of cell populations. Researchers can determine the percentage of cells expressing a particular marker, the intensity of expression, and other quantitative metrics.</p></li>
<li><p><strong>Sequential Gating</strong>: Often, gating is a multi-step process where one gate is applied to isolate a broad population, and subsequent gates are used to progressively narrow down to more specific cell types.</p></li>
</ol></section><section id="why-transform-flowset-to-gatingset" class="level3"><h3 class="anchored" data-anchor-id="why-transform-flowset-to-gatingset"><strong>Why Transform <code>flowSet</code> to <code>GatingSet</code>?</strong></h3>
<p>In R, the transformation of a <strong><code>flowSet</code></strong> object to a <strong><code>GatingSet</code></strong> object is a critical step for gating:</p>
<ol type="1">
<li><p><strong>Structure Adaptation</strong>: <strong><code>flowSet</code></strong> is a collection of flow cytometry samples (FCS files). To apply gating, this data needs to be in a format that can be interacted with gating tools. <strong><code>GatingSet</code></strong> provides this structure.</p></li>
<li><p><strong>Gating Tools Compatibility</strong>: <strong><code>GatingSet</code></strong> is compatible with various gating tools and functions in R. It allows for the application of both manual and automated gating strategies.</p></li>
<li><p><strong>Efficient Handling of Data</strong>: <strong><code>GatingSet</code></strong> objects are designed to handle large datasets efficiently, making them suitable for high-throughput data.</p></li>
<li><p><strong>Integration with Visualization Tools</strong>: Once the data is in a <strong><code>GatingSet</code></strong>, it can be easily visualized using tools like <strong><code>ggcyto</code></strong>, allowing for the visual assessment of gates and the populations they isolate.</p></li>
<li><p><strong>Data Integrity</strong>: Transforming to a <strong><code>GatingSet</code></strong> ensures that the integrity of the original data is maintained while allowing for the sophisticated manipulation needed for gating.</p></li>
</ol>
<p>To be able to add gates, the flowSet has to be transformed to a GatingSet object with the&nbsp;<code>GatingSet</code>&nbsp;function</p>
<div class="cell" data-hash="FACS_cache/html/unnamed-chunk-14_636ac0d30bd91d0e1fd85a5152d57588">
<details><summary>Code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html">GatingSet</a></span><span class="op">(</span><span class="va">fs_comp_clean_trans</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="FACS_cache/html/cell gating_2872587728bf1fc1ff5fae5d0d9f8806">
<details><summary>Code</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#cell gate</span></span>
<span><span class="va">fs_data</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gh_pop_get_data.html">gs_pop_get_data</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></span>
<span><span class="va">my_gate</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/fsApply.html">fsApply</a></span><span class="op">(</span><span class="va">fs_data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fr</span><span class="op">)</span> <span class="fu">openCyto</span><span class="fu">:::</span><span class="fu">.flowClust.2d</span><span class="op">(</span><span class="va">fr</span>, channels<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FSC.A"</span>,<span class="st">"SSC.A"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>'K' argument is missing! Using default setting: K = 2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The prior specification has no effect when usePrior=no</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the serial version of flowClust</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>'K' argument is missing! Using default setting: K = 2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The prior specification has no effect when usePrior=no</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the serial version of flowClust</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>'K' argument is missing! Using default setting: K = 2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The prior specification has no effect when usePrior=no</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the serial version of flowClust</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>'K' argument is missing! Using default setting: K = 2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The prior specification has no effect when usePrior=no</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the serial version of flowClust</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>'K' argument is missing! Using default setting: K = 2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The prior specification has no effect when usePrior=no</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the serial version of flowClust</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gs_pop_add.html">gs_pop_add</a></span><span class="op">(</span><span class="va">gs</span>, <span class="va">my_gate</span>, parent <span class="op">=</span> <span class="st">"root"</span>, name<span class="op">=</span><span class="st">"my_gate"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/recompute.html">recompute</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>done!</code></pre>
</div>
</div>
<div class="cell" data-hash="FACS_cache/html/plot each set_45495b0a4ac2ec97409049a1ae689daa">
<details><summary>Code</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Generate the plot for each sample</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">gs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, x<span class="op">=</span><span class="st">"FSC.A"</span>, y<span class="op">=</span><span class="st">"SSC.A"</span>, <span class="st">"my_gate"</span>, bins<span class="op">=</span><span class="fl">256</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Print the plot</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Optionally, you can save each plot to a file</span></span>
<span>    <span class="co"># ggsave(filename=paste("plot_", i, ".png", sep=""), plot=p)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.
Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FACS_files/figure-html/plot%20each%20set-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FACS_files/figure-html/plot%20each%20set-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FACS_files/figure-html/plot%20each%20set-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FACS_files/figure-html/plot%20each%20set-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="FACS_files/figure-html/plot%20each%20set-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="FACS_cache/html/setup single gate_900dbd74d542c6336cabc1beb0b6f75d">
<details><summary>Code</summary><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#cell gate</span></span>
<span><span class="co">#Singlet gate</span></span>
<span><span class="va">fs_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gh_pop_get_data.html">gs_pop_get_data</a></span><span class="op">(</span><span class="va">gs</span>, <span class="st">"my_gate"</span><span class="op">)</span> <span class="co">#get parent data</span></span>
<span><span class="va">singlet_gate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/fsApply.html">fsApply</a></span><span class="op">(</span><span class="va">fs_data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fr</span><span class="op">)</span> <span class="fu">openCyto</span><span class="fu">:::</span><span class="fu">.singletGate</span><span class="op">(</span><span class="va">fr</span>, channels <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FSC.A"</span>, <span class="st">"FSC.H"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gs_pop_add.html">gs_pop_add</a></span><span class="op">(</span><span class="va">gs</span>, <span class="va">singlet_gate</span>, parent <span class="op">=</span> <span class="st">"my_gate"</span>, name <span class="op">=</span> <span class="st">"singlets"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/recompute.html">recompute</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>done!</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">gs</span>, x <span class="op">=</span> <span class="st">'FSC.A'</span>, y <span class="op">=</span> <span class="st">'FSC.H'</span>, <span class="st">"singlets"</span>, bins <span class="op">=</span> <span class="fl">256</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FACS_files/figure-html/setup%20single%20gate-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="FACS_cache/html/plot each set of single gate_38805cea3c37a9ec311722d9cfa3cc5b">
<details><summary>Code</summary><div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Generate the plot for each sample</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">gs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, x<span class="op">=</span><span class="st">"FSC.A"</span>, y<span class="op">=</span><span class="st">"FSC.H"</span>, <span class="st">"singlets"</span>, bins<span class="op">=</span><span class="fl">256</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Print the plot</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Optionally, you can save each plot to a file</span></span>
<span>    <span class="co"># ggsave(filename=paste("plot_", i, ".png", sep=""), plot=p)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.
Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FACS_files/figure-html/plot%20each%20set%20of%20single%20gate-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FACS_files/figure-html/plot%20each%20set%20of%20single%20gate-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FACS_files/figure-html/plot%20each%20set%20of%20single%20gate-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FACS_files/figure-html/plot%20each%20set%20of%20single%20gate-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="FACS_files/figure-html/plot%20each%20set%20of%20single%20gate-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Quad gate (optional)</p>
<div class="cell" data-hash="FACS_cache/html/unnamed-chunk-19_dd84bb031f4b081d14b1df76bcf2a519">
<details><summary>Code</summary><div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Quad gate (optional)</span></span>
<span><span class="co">#fs_comp_clean_trans[[1]]@parameters@data</span></span>
<span><span class="co">#fs_data &lt;- gs_pop_get_data(gs, "singlets") #get parent data</span></span>
<span><span class="co">#BGquad_gate &lt;- fsApply(fs_data, function(fr) openCyto:::.quadGate.seq(fr, gFunc="mindensity", min=c(3,3), channels =c('BUV737.A', 'BUV805.A')))</span></span>
<span><span class="co">#gs_pop_add(gs, BGquad_gate, parent = "singlets", names = c("1", "2", "3", "4"))</span></span>
<span><span class="co">#recompute(gs)</span></span>
<span><span class="co">#gs_get_pop_paths(gs[[1]])</span></span>
<span><span class="co">#plot(gs)</span></span>
<span><span class="co">#autoplot(gs, x = 'BUV737.A', y = 'BUV805.A', gs_get_pop_paths(auto_gs)[5:32], bins = 256)</span></span>
<span></span>
<span><span class="co">#fix plot</span></span>
<span><span class="co">#p&lt;-ggcyto(auto_gs[1:2],aes(x = 'X.BUV737.A', y = 'BUV805.A'), subset="singlets", arrange = FALSE)</span></span>
<span><span class="co">#p&lt;- p + geom_hex(bins=256)</span></span>
<span><span class="co">#p&lt;- p + geom_gate(gs_get_pop_paths(auto_gs)[5:32]) </span></span>
<span><span class="co">#p&lt;- p + geom_stats(gs_get_pop_paths(auto_gs)[5:32])</span></span>
<span><span class="co">#p&lt;- p + theme(strip.text = element_text(size = 7))</span></span>
<span><span class="co">#myPars &lt;- ggcyto_par_set(limits = list(y = c(3,5), x = c(3,5)))</span></span>
<span><span class="co">#p&lt;- p  + myPars</span></span>
<span><span class="co">#p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="statistics" class="level2"><h2 class="anchored" data-anchor-id="statistics">Statistics</h2>
<section id="gs_pop_get_statsgs" class="level3"><h3 class="anchored" data-anchor-id="gs_pop_get_statsgs"><strong><code>gs_pop_get_stats(gs)</code></strong></h3>
<ul>
<li><p><strong>Purpose</strong>: This command retrieves basic statistical information for all cell populations in the <strong><code>GatingSet</code></strong>.</p></li>
<li><p><strong>Importance</strong>: It provides an overview of the cell populations identified by gating, including counts and percentages, which are fundamental for understanding the composition of your sample.</p></li>
</ul></section><section id="gs_pop_get_statsgs-my_gate-percent" class="level3"><h3 class="anchored" data-anchor-id="gs_pop_get_statsgs-my_gate-percent"><strong>2. <code>gs_pop_get_stats(gs, "my_gate", "percent")</code></strong></h3>
<ul>
<li><p><strong>Purpose</strong>: This retrieves the percentage of cells in a specific gate (<strong><code>"my_gate"</code></strong>) relative to the parent population.</p></li>
<li><p><strong>Importance</strong>: Understanding the proportion of a specific cell population (e.g., a particular type of immune cell) is crucial in many biological and medical contexts, such as determining the prevalence of a cell type in a disease state.</p></li>
</ul></section><section id="gs_pop_get_statsgs-my_gate-type-pop.mfi" class="level3"><h3 class="anchored" data-anchor-id="gs_pop_get_statsgs-my_gate-type-pop.mfi"><strong>3. <code>gs_pop_get_stats(gs, "my_gate", type = pop.MFI)</code></strong></h3>
<ul>
<li><p><strong>Purpose</strong>: Retrieves the Mean Fluorescence Intensity (MFI) for the population in <strong><code>"my_gate"</code></strong>.</p></li>
<li><p><strong>Importance</strong>: MFI is a measure of the average fluorescence intensity of a cell population, indicating the level of expression of a fluorescent marker. This is particularly important in assessing the expression levels of proteins of interest, like receptors or antigens on cell surfaces.</p></li>
</ul></section><section id="gs_pop_get_statsgs-gs_get_pop_pathsgs-type-pop.quantiles" class="level3"><h3 class="anchored" data-anchor-id="gs_pop_get_statsgs-gs_get_pop_pathsgs-type-pop.quantiles"><strong>4. <code>gs_pop_get_stats(gs, gs_get_pop_paths(gs), type = pop.quantiles)</code></strong></h3>
<ul>
<li><p><strong>Custom Function</strong>: <strong><code>pop.quantiles</code></strong> calculates the 75th percentile (or any other specified quantile) for each channel.</p></li>
<li><p><strong>Purpose</strong>: This command applies the custom <strong><code>pop.quantiles</code></strong> function to each gated population.</p></li>
<li><p><strong>Importance</strong>: Quantiles provide insights into the distribution of fluorescence intensities, which can be critical for understanding variability within cell populations and for identifying subpopulations with higher or lower marker expression.</p></li>
</ul></section><section id="gs_pop_get_statsgs-gs_get_pop_pathsgs-type-pop.mean" class="level3"><h3 class="anchored" data-anchor-id="gs_pop_get_statsgs-gs_get_pop_pathsgs-type-pop.mean"><strong>5. <code>gs_pop_get_stats(gs, gs_get_pop_paths(gs), type = pop.mean)</code></strong></h3>
<ul>
<li><p><strong>Custom Function</strong>: <strong><code>pop.mean</code></strong> calculates the mean of each channel.</p></li>
<li><p><strong>Purpose</strong>: Applies the custom <strong><code>pop.mean</code></strong> function to each gated population.</p></li>
<li><p><strong>Importance</strong>: The mean is a basic statistical measure that provides an average value for fluorescence intensity or other parameters across a cell population. This is useful for comparing the overall expression levels of markers across different samples or conditions.</p></li>
</ul>
<div class="cell" data-hash="FACS_cache/html/statistics_7515711d7dbb458551704a125a3cff67">
<details><summary>Code</summary><div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gs_pop_get_stats.html">gs_pop_get_stats</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                                               sample               pop   count
 1: Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs              root 2143038
 2: Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs          /my_gate 1323685
 3: Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs /my_gate/singlets 1168911
 4:      Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs              root 1140174
 5:      Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs          /my_gate  626947
 6:      Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs /my_gate/singlets  569916
 7:     Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs              root 1665569
 8:     Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs          /my_gate  833055
 9:     Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs /my_gate/singlets  762069
10:      Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs              root  764319
11:      Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs          /my_gate  429130
12:      Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs /my_gate/singlets  403781
13:         Specimen_001_MS_01_NF_HC_del_18-10-21.fcs              root  764441
14:         Specimen_001_MS_01_NF_HC_del_18-10-21.fcs          /my_gate  592955
15:         Specimen_001_MS_01_NF_HC_del_18-10-21.fcs /my_gate/singlets  570704</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gs_pop_get_stats.html">gs_pop_get_stats</a></span><span class="op">(</span><span class="va">gs</span>, <span class="st">"my_gate"</span>, <span class="st">"percent"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                                              sample     pop   percent
1: Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs my_gate 0.6176675
2:      Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs my_gate 0.5498696
3:     Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs my_gate 0.5001624
4:      Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs my_gate 0.5614541
5:         Specimen_001_MS_01_NF_HC_del_18-10-21.fcs my_gate 0.7756714</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gs_pop_get_stats.html">gs_pop_get_stats</a></span><span class="op">(</span><span class="va">gs</span>, <span class="st">"my_gate"</span>, type <span class="op">=</span> <span class="va">pop.MFI</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                                              sample     pop       CD24
1: Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs my_gate  0.4555632
2:      Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs my_gate  0.4248082
3:     Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs my_gate  0.4188850
4:      Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs my_gate  0.5520756
5:         Specimen_001_MS_01_NF_HC_del_18-10-21.fcs my_gate -0.3177117
         IgD      CD56      CD38     CD275      CD16     CD45      CD3
1: 0.8040798 0.6978843 1.3808463 0.8064132 0.6887691 1.781786 1.431500
2: 0.9525296 0.9573753 1.4068434 0.7751421 0.8361252 1.794722 1.894951
3: 0.8471122 0.9338869 1.3921863 0.7793287 0.6713067 1.758022 1.701987
4: 1.1171751 1.0563503 1.4442150 0.8241753 0.2952129 1.818162 2.348475
5: 0.0338638 3.0353866 0.8618503 2.9383919 4.7390866 2.403476 2.900859
      CD45RA      CD19     CD11c       CD4       CD8     CD278       CD196
1: 0.9525140 0.7998642 0.7999142 0.8266100 0.5865358 0.8534620  0.70559222
2: 1.0228018 1.2042673 1.1071998 0.9770468 0.7608919 0.8392757  0.82552731
3: 0.9790002 0.7990420 0.8338276 0.8925269 0.5631332 0.8174304  0.73551410
4: 1.1093114 1.5172297 1.2651788 1.0149724 0.8915476 0.9136420  0.76181051
5: 0.8631308 1.0096762 2.8702183 2.7291141 3.0986960 0.9854424 -0.01543122
        CD27    HLA-DR       CD28     CCR7     CD20    CD127     CXCR3
1: 0.8449789 0.9566186 1.01818907 1.171393 1.019689 1.468196 0.8005229
2: 1.0817962 1.2043340 1.18717539 1.503961 1.121609 1.891356 0.7435885
3: 0.8925235 0.9819790 1.07702005 1.724633 0.996396 2.060638 0.8521636
4: 1.1497859 1.3811343 1.31826776 1.631143 1.263272 2.363360 1.0784648
5: 0.2864449 2.7567995 0.04206265 2.836195 1.937113 5.180017 1.6720845
        CD25   FVS780     CD194    CD123    CD45RO      CD14
1: 1.0983193 1.383175 1.4141036 1.030126 0.6728262 0.5422211
2: 1.1584529 1.463462 1.3165683 1.188062 0.7431490 0.5200976
3: 1.0653297 1.413406 1.3559465 1.084381 0.6678938 0.4776639
4: 1.1552863 1.533298 1.3676369 1.022725 1.6215312 0.3910820
5: 0.2269123 3.309585 0.9545025 1.245579 3.5023572 1.9185680</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pop.quantiles</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fr</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">chnls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">fr</span><span class="op">)</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">matrixStats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matrixStats/man/rowQuantiles.html">colQuantiles</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html">exprs</a></span><span class="op">(</span><span class="va">fr</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">chnls</span></span>
<span>  <span class="va">res</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gs_pop_get_stats.html">gs_pop_get_stats</a></span><span class="op">(</span><span class="va">gs</span>, <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gs_get_pop_paths.html">gs_get_pop_paths</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span>, type <span class="op">=</span> <span class="va">pop.quantiles</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                                               sample               pop
 1: Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs              root
 2: Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs          /my_gate
 3: Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs /my_gate/singlets
 4:      Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs              root
 5:      Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs          /my_gate
 6:      Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs /my_gate/singlets
 7:     Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs              root
 8:     Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs          /my_gate
 9:     Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs /my_gate/singlets
10:      Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs              root
11:      Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs          /my_gate
12:      Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs /my_gate/singlets
13:         Specimen_001_MS_01_NF_HC_del_18-10-21.fcs              root
14:         Specimen_001_MS_01_NF_HC_del_18-10-21.fcs          /my_gate
15:         Specimen_001_MS_01_NF_HC_del_18-10-21.fcs /my_gate/singlets
        FSC.A     FSC.H      SSC.A      SSC.H   BB515.A   BB630.A BB660.P.A
 1: 118799.91  95485.65  32306.367  29293.087 1.0225819 1.3571331 1.7842711
 2:  34817.47  33216.27   8945.734   7965.795 0.5782937 0.9126703 0.8860598
 3:  33355.71  33271.51   8530.130   7932.124 0.5753103 0.9078628 0.8828593
 4: 193042.19 165208.91 161539.590 135941.539 0.6420040 1.7440910 2.6054227
 5: 106175.59  94980.81  32124.667  26472.934 0.6341038 1.4054849 1.4413835
 6: 104066.93  94081.92  30962.175  25932.066 0.6272692 1.3610540 1.4001578
 7: 147100.83 102414.66 170051.688 131058.477 0.7704511 1.9208666 2.9210453
 8:  37052.79  31072.17  14266.966  10061.776 0.5817676 0.9882460 1.2564142
 9:  34822.93  30986.51  13587.232   9971.558 0.5760925 0.9780500 1.2405897
10: 173582.10 117897.21 178493.219 139178.508 0.8048811 2.0042949 3.1250925
11:  95453.14  75422.45  29800.463  25684.992 0.8761882 1.8381760 1.5085751
12:  94011.52  74990.89  29280.043  25447.635 0.8626474 1.8227196 1.4909705
13: 151312.56 112535.85 240142.594 175079.422 1.0211854 0.9977908 3.2928505
14: 157109.41 117817.42 244453.742 178591.680 1.2095602 0.7397709 3.3575314
15: 156776.39 117896.76 243745.070 178873.012 1.2070535 0.7339790 3.3571717
     BB700.A BB755.P.A BB790.P.A BUV395.A BUV496.A  BUV563.A  BUV615.A BUV661.A
 1: 1.436830 0.9096797 2.2040421 2.567716 2.240213 0.9995009 1.4731880 2.560044
 2: 1.422122 0.8599826 0.9294602 1.800376 1.585821 0.9844697 0.9758059 1.022683
 3: 1.417970 0.8592473 0.9260978 1.796402 1.564205 0.9832499 0.9705846 1.022841
 4: 1.491264 0.8203314 3.8644878 3.038435 3.104963 1.4455382 2.2549040 2.817691
 5: 1.545458 0.8580894 1.5548580 2.698998 2.804223 1.8364929 2.1298145 2.026967
 6: 1.532297 0.8579840 1.5047313 2.592617 2.760899 1.7243083 2.0838577 1.954559
 7: 1.471018 0.9523893 4.4035072 2.913060 3.042586 1.1211922 1.6585273 2.928717
 8: 1.459557 0.8567005 1.2545462 1.779020 1.910351 1.0267847 1.0104187 1.096818
 9: 1.452734 0.8560830 1.2554436 1.776140 1.878863 1.0232607 1.0039830 1.095503
10: 1.660660 0.9373119 4.7188368 3.681557 3.246880 1.3678318 2.4512466 3.028981
11: 1.777646 0.9490955 0.6976046 3.971155 3.838973 1.9815176 2.5269956 2.577937
12: 1.755481 0.9450492 0.7054000 3.965832 3.832609 1.9003451 2.5164416 2.558895
13: 1.548020 3.0201764 4.9177241 2.777322 3.034852 1.2073373 1.6230304 3.123109
14: 1.248411 3.0405698 5.0174768 2.681957 3.044165 1.1433458 1.6310433 3.132012
15: 1.243262 3.0386683 5.0173120 2.678287 3.041101 1.1391472 1.6249044 3.129178
    BUV737.A  BUV805.A   BV421.A   BV510.A  BV570.A  BV605.A  BV650.A  BV711.A
 1: 2.344754 2.0010984 0.9515517 1.1654121 1.796331 1.744043 1.299342 2.206685
 2: 1.057187 0.7458318 0.9371809 0.8720694 1.056035 1.175588 1.155108 1.467783
 3: 1.053374 0.7445619 0.9358446 0.8701210 1.052353 1.172933 1.154546 1.462717
 4: 2.736438 2.6385537 1.1189625 1.7657723 2.004331 2.393923 1.849060 2.913574
 5: 1.673607 1.8035716 0.9736338 1.3502578 1.897489 1.845377 2.015347 2.108377
 6: 1.621900 1.7298459 0.9706768 1.3203189 1.814688 1.789739 1.950039 2.083134
 7: 2.532255 2.8956244 0.8872647 2.6714885 2.365991 2.139218 1.468663 3.101572
 8: 1.184957 0.7945482 0.9099144 1.3163831 1.159182 1.246452 1.268146 2.041206
 9: 1.180240 0.7922980 0.9080443 1.3072516 1.151505 1.244215 1.264363 2.029851
10: 3.490000 2.5822388 1.4145924 2.0638223 2.076880 2.973554 2.512869 3.656125
11: 2.666400 2.4075986 1.0944149 2.2790880 2.809227 2.653318 2.926810 3.134207
12: 2.595786 2.3923705 1.0886089 2.2687168 2.773644 2.639641 2.910369 3.100557
13: 3.422866 3.2833538 1.5485079 1.0746269 1.589556 2.940489 2.029081 3.699563
14: 3.505022 3.3152232 1.8836275 0.7854498 1.476962 2.969811 1.871631 3.891394
15: 3.504657 3.3133813 1.8830094 0.7888996 1.467769 2.968649 1.866076 3.891021
     BV750.A  BV786.A    APC.A APC.R700.A APC.H7.A PE.CF594.A PE.Cy5.A
 1: 1.216026 2.984869 1.642829  1.2045615 1.577249   1.496202 1.465480
 2: 1.108591 1.800049 1.007462  1.1742405 1.473730   1.505966 1.282931
 3: 1.108140 1.788141 1.001538  1.1742613 1.473462   1.493342 1.280004
 4: 1.986645 3.536749 1.006769  1.6386158 2.522616   1.398083 1.695513
 5: 1.661112 2.641911 1.066980  1.5519106 1.685126   1.541021 1.614394
 6: 1.587634 2.582411 1.052725  1.4860414 1.667255   1.534203 1.594305
 7: 2.366349 4.778928 2.099802  1.3422393 2.820374   1.449044 1.864813
 8: 1.168896 2.352608 1.134876  1.1678792 1.519527   1.459408 1.319243
 9: 1.166455 2.344165 1.124092  1.1676159 1.518948   1.448987 1.314537
10: 2.470329 5.290210 2.829410  1.9864265 2.924330   1.668231 1.356459
11: 2.385961 3.848172 1.760278  1.8164874 2.806904   1.613712 1.382981
12: 2.368853 3.835701 1.706468  1.7450117 2.791509   1.607179 1.372074
13: 2.392456 5.240260 2.810470  0.9856487 3.482503   2.056818 1.922332
14: 2.425024 5.256010 2.885432  0.5592381 3.526229   2.181109 1.785380
15: 2.419689 5.252387 2.884755  0.5464133 3.524235   2.180156 1.781370
     PE.Cy7.A      PE.A     Time
 1: 2.1332358 1.1557969 43643.68
 2: 0.8698841 0.6718572 45133.19
 3: 0.8624892 0.6711874 45011.56
 4: 1.9660510 1.8006794 22616.09
 5: 1.2389718 0.7778951 23482.45
 6: 1.2030188 0.7702291 23448.67
 7: 3.1750600 1.4549595 17232.28
 8: 0.9463320 0.6196927 17786.52
 9: 0.9350309 0.6199389 17807.43
10: 3.7520194 1.8867834 15919.11
11: 2.7542314 0.6354963 16423.50
12: 2.7330084 0.6311595 16474.95
13: 3.6491466 2.1903453 17125.66
14: 3.6631296 2.1686339 16864.01
15: 3.6620183 2.1674954 16896.36</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pop.mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fr</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">chnls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">fr</span><span class="op">)</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html">exprs</a></span><span class="op">(</span><span class="va">fr</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">chnls</span></span>
<span>  <span class="va">res</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gs_pop_get_stats.html">gs_pop_get_stats</a></span><span class="op">(</span><span class="va">gs</span>, <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gs_get_pop_paths.html">gs_get_pop_paths</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span>, type <span class="op">=</span> <span class="va">pop.mean</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                                               sample               pop
 1: Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs              root
 2: Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs          /my_gate
 3: Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs /my_gate/singlets
 4:      Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs              root
 5:      Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs          /my_gate
 6:      Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs /my_gate/singlets
 7:     Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs              root
 8:     Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs          /my_gate
 9:     Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs /my_gate/singlets
10:      Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs              root
11:      Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs          /my_gate
12:      Specimen_001_IF_MS_05_AB_HC_del_25-03-22.fcs /my_gate/singlets
13:         Specimen_001_MS_01_NF_HC_del_18-10-21.fcs              root
14:         Specimen_001_MS_01_NF_HC_del_18-10-21.fcs          /my_gate
15:         Specimen_001_MS_01_NF_HC_del_18-10-21.fcs /my_gate/singlets
        FSC.A    FSC.H      SSC.A      SSC.H      BB515.A     BB630.A BB660.P.A
 1:  80509.81 68939.27  41508.476  34546.215  0.791013097  1.08682769 1.2684651
 2:  29883.36 28944.57   7255.839   6764.918  0.482319675  0.80574299 0.7059177
 3:  29003.37 28973.81   6970.830   6735.243  0.480175264  0.80229182 0.7045628
 4: 115761.17 99045.96  82460.661  67196.277  0.255889493  1.22869189 1.7358824
 5:  60107.87 54223.57  22808.497  17652.622  0.457272702  1.14479563 1.1411383
 6:  58120.51 53470.29  21941.296  17252.363  0.453494913  1.12720774 1.1145928
 7:  92177.33 66547.80  78741.152  59378.540  0.440019391  1.16276881 1.8259897
 8:  33394.05 28933.59  11886.141   9048.508  0.457663950  0.87567095 0.9601000
 9:  32170.25 28798.16  11455.118   8987.829  0.453587628  0.86871001 0.9483482
10: 109022.25 78082.11  85294.055  65956.193  0.179165732  1.01127609 1.9291148
11:  58388.92 47977.49  19618.133  16362.950  0.667209927  1.32169426 1.1064673
12:  56995.65 47457.72  19138.197  16140.458  0.660271838  1.30781964 1.0934780
13: 109886.79 81811.96 190909.350 139567.201  0.076724101  0.20097245 2.8033088
14: 119588.52 88805.07 224264.870 164464.046 -0.004368032 -0.05238192 3.0972730
15: 118599.21 88573.86 223737.890 164837.236 -0.004239847 -0.05579236 3.0959910
      BB700.A BB755.P.A BB790.P.A BUV395.A BUV496.A  BUV563.A  BUV615.A
 1: 1.3343265 0.8703122 1.6371842 2.184099 1.881410 1.0372986 1.1011058
 2: 1.3882853 0.8098101 0.8134809 1.786152 1.421771 0.9532268 0.7976292
 3: 1.3849557 0.8097317 0.8132606 1.783173 1.403707 0.9522227 0.7938152
 4: 1.3966909 0.4025120 2.2803045 2.431837 2.553651 1.3864727 1.7552356
 5: 1.5919898 0.7076309 1.1081180 2.314036 2.252338 1.4889274 1.4674642
 6: 1.5814446 0.7115914 1.0900189 2.292520 2.224482 1.4664577 1.4392103
 7: 1.2901421 0.7076691 2.2428829 2.358685 2.345238 1.1877656 0.9791902
 8: 1.4367809 0.7834221 0.9013540 1.833253 1.735471 1.0464804 0.7833670
 9: 1.4328017 0.7832788 0.9032599 1.833731 1.712900 1.0462431 0.7782012
10: 1.1573002 0.3247047 1.5737882 2.780997 2.871729 1.3205197 1.9127677
11: 1.6668449 0.8683513 0.1014707 2.655000 2.789668 1.5324808 1.7602374
12: 1.6573771 0.8661414 0.1175024 2.632686 2.769870 1.5197725 1.7400604
13: 0.9386695 1.6796514 4.2137019 2.508817 2.583043 1.0420102 0.8350178
14: 0.6507765 1.6892102 4.7509196 2.466298 2.686511 0.8874411 0.8303980
15: 0.6467911 1.6858724 4.7502730 2.463039 2.676383 0.8820073 0.8266794
     BUV661.A  BUV737.A  BUV805.A   BV421.A   BV510.A   BV570.A   BV605.A
 1: 1.4757885 1.4179035 1.2696574 0.8373086 0.9742608 1.2352067 1.3209678
 2: 0.8139610 0.8356720 0.6058094 0.8565561 0.7171388 0.8490687 0.9565178
 3: 0.8158860 0.8341127 0.6059053 0.8554285 0.7159483 0.8464312 0.9551678
 4: 1.9007379 1.8225319 1.7082711 0.9486839 1.1309990 1.3132950 1.7212415
 5: 1.3316486 1.2996276 1.1603854 0.8326767 0.9895322 1.3483229 1.4032012
 6: 1.3094730 1.2936701 1.1357560 0.8337147 0.9727436 1.3347126 1.3813735
 7: 1.7159374 1.6170821 1.4398704 0.6181029 1.7408013 1.4758774 1.4758299
 8: 0.8688768 0.9239109 0.6559079 0.8011166 0.8870212 0.9462508 1.0216827
 9: 0.8692645 0.9210764 0.6570100 0.7989526 0.8799816 0.9417255 1.0222767
10: 2.0230719 1.9667624 1.0939567 1.0024574 1.1576584 0.9979036 2.1803145
11: 1.5281696 1.5326676 1.4859746 0.9516592 1.2551349 1.5727323 1.7004754
12: 1.5121196 1.5192994 1.4639967 0.9501281 1.2417838 1.5571318 1.6810016
13: 2.2143488 2.6294542 1.5647405 1.0695045 0.4417717 0.4901186 2.5672075
14: 2.3513515 2.8291845 1.5763776 1.1673983 0.2493365 0.2872330 2.7494089
15: 2.3506888 2.8460263 1.5714233 1.1657214 0.2510934 0.2818608 2.7480124
      BV650.A  BV711.A  BV750.A  BV786.A     APC.A APC.R700.A APC.H7.A
 1: 1.1899026 1.646858 1.177650 2.282186 1.2095091  1.1112853 1.568521
 2: 1.0235324 1.176845 1.025565 1.428508 0.8103149  1.0988301 1.385161
 3: 1.0240708 1.174783 1.025915 1.418941 0.8062946  1.0996103 1.385044
 4: 1.3935355 2.094922 1.407399 2.600502 0.6124772  1.3759552 1.939528
 5: 1.4841341 1.629011 1.398688 1.980612 0.8224935  1.4051451 1.620107
 6: 1.4681994 1.625324 1.381546 1.962671 0.8109249  1.3910683 1.610712
 7: 1.1644468 2.345948 1.447283 3.129557 1.4498764  1.1833536 1.881216
 8: 1.1284746 1.691970 1.064314 1.953270 0.8871225  1.0904744 1.452176
 9: 1.1276582 1.682902 1.064954 1.944622 0.8797978  1.0914243 1.452908
10: 1.6136852 2.291726 1.205127 3.600501 1.6911638  1.3258889 1.683537
11: 1.7518871 1.891075 1.611481 2.614425 1.3032262  1.4354949 1.978812
12: 1.7381865 1.877119 1.595712 2.587970 1.2865408  1.4264465 1.963695
13: 0.8298791 2.596815 1.126650 4.657630 1.6137766  0.5098114 2.096633
14: 0.6496923 2.835236 1.024435 5.111144 1.6076069  0.2228484 2.122042
15: 0.6495095 2.857183 1.017997 5.107803 1.6106197  0.2118075 2.118437
    PE.CF594.A  PE.Cy5.A  PE.Cy7.A      PE.A     Time
 1:  1.2545610 1.2111721 1.2920922 0.8796262 34404.58
 2:  1.4287188 1.0294345 0.6821349 0.5467341 35548.36
 3:  1.4186498 1.0272761 0.6767465 0.5468384 35227.23
 4:  0.9552987 1.2856839 1.2679081 1.1804722 15347.32
 5:  1.1662676 1.2876228 0.9356116 0.6221398 15922.26
 6:  1.1714446 1.2728955 0.9204309 0.6149227 15871.84
 7:  1.1439352 1.4713159 1.7988746 0.8797887 11542.40
 8:  1.3700348 1.1105522 0.7234907 0.4650024 11872.32
 9:  1.3617288 1.1073464 0.7160822 0.4652475 11887.43
10:  1.1072595 0.9992189 2.6842605 1.0809576 10794.96
11:  1.1363538 1.1324422 1.9404992 0.4675218 11086.34
12:  1.1395938 1.1265772 1.9107874 0.4673440 11114.23
13:  1.3138104 1.3819319 3.2148322 1.8443790 11679.72
14:  1.3212441 1.2462890 3.5022005 1.9262510 11518.10
15:  1.3219149 1.2446996 3.5015260 1.9253827 11550.16</code></pre>
</div>
</div>
</section></section><section id="get-populations-stats-for-downstream-analysis" class="level2"><h2 class="anchored" data-anchor-id="get-populations-stats-for-downstream-analysis">Get populations stats for downstream analysis</h2>
<p>To get the data from each gating step from the&nbsp;<code>GatingSet</code>, we can use the&nbsp;<code>gs_pop_get_count_with_meta</code>function (which conveniently also retrieves all the metadata and sample names you might have added).</p>
<p>Stats:</p>
<ul>
<li><p><strong>Count:</strong> This is the number of events (e.g., cells or particles) that fall within a specific gate in a flow cytometry experiment. In the context of flow cytometry, “events” typically mean individual cells that have been detected and recorded by the cytometer.</p></li>
<li><p><strong>ParentCount:</strong> This refers to the number of events in the parent population from which a subset (child gate) was derived. In gating hierarchies, you often start with a broad population (like all detected events) and apply gates to sequentially narrow down to specific populations of interest. The “ParentCount” is the count of the broader population before the more specific gate was applied.</p></li>
<li><p><strong>percent_of_parent:</strong> This is a calculated field that represents the proportion of events in a specific gate relative to the parent population. It’s calculated by dividing the “Count” by the “ParentCount” and typically expressed as a percentage. This gives you an idea of how many cells from the original parent population fall into a more specific category defined by your gating strategy.</p></li>
</ul>
<div class="cell" data-hash="FACS_cache/html/Get populations stats for downstream analysis_348fdcc11140d67d55c6cb2a6a169727">
<details><summary>Code</summary><div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gs_pop_get_count_fast.html">gs_pop_get_count_with_meta</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Processing sample names..</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>merging..</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Done</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="va">ps</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>percent_of_parent<span class="op">=</span><span class="va">Count</span><span class="op">/</span><span class="va">ParentCount</span><span class="op">)</span></span>
<span></span>
<span><span class="va">styled_table</span> <span class="op">&lt;-</span> <span class="va">ps</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sampleName</span>, <span class="va">well</span>, <span class="va">Population</span>, <span class="va">Count</span>, <span class="va">ParentCount</span>, <span class="va">percent_of_parent</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html">cell_spec</a></span><span class="op">(</span><span class="va">.x</span>, background <span class="op">=</span> <span class="st">"black"</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="st">"html"</span>, escape <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>, full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This will print the table in your R Markdown document</span></span>
<span><span class="va">styled_table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">sampleName</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">well</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Population</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Count</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ParentCount</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">percent_of_parent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">17-10-22</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">/my_gate</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">1323685</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">2143038</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">0.617667535526668</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">17-10-22</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">/my_gate/singlets</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">1168911</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">1323685</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">0.883073389817064</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">07-12-22</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">/my_gate</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">626947</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">1140174</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">0.549869581309519</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">Specimen_001_IF_HC_MS_09_MS_del_07-12-22.fcs</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">07-12-22</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">/my_gate/singlets</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">569916</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">626947</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">0.909033777974853</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">30-03-22</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">/my_gate</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">833055</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">1665569</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">0.500162406961225</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">Specimen_001_IF_MS_015_BR_HC_del_30-03-22.fcs</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">30-03-22</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">/my_gate/singlets</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">762069</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">833055</span></td>
<td style="text-align: left;"><span style="     color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: black !important;">0.914788339305328</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="save-the-whole-analysis-in-rdata-file" class="level2"><h2 class="anchored" data-anchor-id="save-the-whole-analysis-in-rdata-file">Save the whole analysis in Rdata file</h2>
<div class="cell" data-hash="FACS_cache/html/save the data_510c69084dd5d140875c1ef54dbc4d1b">
<details><summary>Code</summary><div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#save.image(file = "facs_data_with_plots_stats.Rdata")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="FACS_cache/html/unnamed-chunk-23_daf40a07bd93f09fbb8f5d129efde3e9">
<details><summary>Code</summary><div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#renv::snapshot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!-- -->

</section></section></main><!-- /main column --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb129" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Flow Cytometry Data Analysis in R"</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Pritam Kumar Panda"</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="an">institution:</span><span class="co"> "German Cancer Research Center DKFZ"</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="an">country:</span><span class="co"> "Germany"</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-link: true</span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="co">    cache: true</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## </span></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a><span class="fu"># High-throughput FACS analyses with R</span></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>Evaluating flow cytometry data using R might appear intimidating initially, but I strongly encourage its adoption for individuals conducting medium to high-throughput FACS-based experiments. Even when examining a limited number of markers, conventional flow analysis software such as FlowJo struggles when dealing with extensive sample datasets. It operates slowly, is susceptible to crashes, and exporting large plots can be cumbersome. In contrast, R-based flow cytometry analysis excels in addressing these challenges effectively. Various R packages are available for the analysis of flow cytometry data, offering versatile solutions for researchers.</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/flow_cytometry.png)</span></span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a>The packages I am using in this tutorial and which I highly recommend are:</span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>flowCore</span>
<span id="cb129-27"><a href="#cb129-27" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>flowStats</span>
<span id="cb129-28"><a href="#cb129-28" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>flowAI</span>
<span id="cb129-29"><a href="#cb129-29" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>cytoML</span>
<span id="cb129-30"><a href="#cb129-30" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>openCyto</span>
<span id="cb129-31"><a href="#cb129-31" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>flowWorkspace</span>
<span id="cb129-32"><a href="#cb129-32" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>ggcyto</span>
<span id="cb129-33"><a href="#cb129-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-34"><a href="#cb129-34" aria-hidden="true" tabindex="-1"></a>Other helpful links for parameters: <span class="ot">&lt;https://fcsexpressdownloads.s3.amazonaws.com/manual/manual_WIN_RUO/index.html?welcome_to_fcs_express_version.htm&gt;</span></span>
<span id="cb129-35"><a href="#cb129-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-36"><a href="#cb129-36" aria-hidden="true" tabindex="-1"></a>**CytoRSuite**&nbsp;is designed to provide an interactive interface for the analysis of flow cytometry data in R. If you are new to&nbsp;**CytoRSuite**&nbsp;visit&nbsp;<span class="ot">&lt;https://dillonhammill.github.io/CytoRSuite/&gt;</span>&nbsp;to get started.</span>
<span id="cb129-37"><a href="#cb129-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-38"><a href="#cb129-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=TRUE, results='hide'}</span></span>
<span id="cb129-39"><a href="#cb129-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: base packages</span></span>
<span id="cb129-40"><a href="#cb129-40" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb129-41"><a href="#cb129-41" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"knitr"</span>)</span>
<span id="cb129-42"><a href="#cb129-42" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb129-43"><a href="#cb129-43" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb129-44"><a href="#cb129-44" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb129-45"><a href="#cb129-45" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span>
<span id="cb129-46"><a href="#cb129-46" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"kableExtra"</span>)</span>
<span id="cb129-47"><a href="#cb129-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-48"><a href="#cb129-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-49"><a href="#cb129-49" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=TRUE, results='hide'}</span></span>
<span id="cb129-50"><a href="#cb129-50" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Install bioconductor packages</span></span>
<span id="cb129-51"><a href="#cb129-51" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"BiocManager"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb129-52"><a href="#cb129-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb129-53"><a href="#cb129-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-54"><a href="#cb129-54" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"flowCore"</span>)</span>
<span id="cb129-55"><a href="#cb129-55" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"flowWorkspace"</span>)</span>
<span id="cb129-56"><a href="#cb129-56" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"openCyto"</span>)</span>
<span id="cb129-57"><a href="#cb129-57" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"flowAI"</span>)</span>
<span id="cb129-58"><a href="#cb129-58" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"ggcyto"</span>)</span>
<span id="cb129-59"><a href="#cb129-59" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"CytoML"</span>)</span>
<span id="cb129-60"><a href="#cb129-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-61"><a href="#cb129-61" aria-hidden="true" tabindex="-1"></a><span class="co">#optional package to explore further</span></span>
<span id="cb129-62"><a href="#cb129-62" aria-hidden="true" tabindex="-1"></a><span class="co"># CytoExploreR </span></span>
<span id="cb129-63"><a href="#cb129-63" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"DillonHammill/CytoExploreR"</span>)</span>
<span id="cb129-64"><a href="#cb129-64" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"DillonHammill/CytoExploreRData"</span>)</span>
<span id="cb129-65"><a href="#cb129-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-66"><a href="#cb129-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-69"><a href="#cb129-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-70"><a href="#cb129-70" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-packages</span></span>
<span id="cb129-71"><a href="#cb129-71" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb129-72"><a href="#cb129-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flowCore)</span>
<span id="cb129-73"><a href="#cb129-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CytoML)</span>
<span id="cb129-74"><a href="#cb129-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flowAI)</span>
<span id="cb129-75"><a href="#cb129-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flowWorkspace)</span>
<span id="cb129-76"><a href="#cb129-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcyto)</span>
<span id="cb129-77"><a href="#cb129-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb129-78"><a href="#cb129-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CytoExploreR)</span>
<span id="cb129-79"><a href="#cb129-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openCyto)</span>
<span id="cb129-80"><a href="#cb129-80" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CytoExploreRData)</span>
<span id="cb129-81"><a href="#cb129-81" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb129-82"><a href="#cb129-82" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb129-83"><a href="#cb129-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb129-84"><a href="#cb129-84" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-85"><a href="#cb129-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-88"><a href="#cb129-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-89"><a href="#cb129-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: increase memory and use cache of larger files</span></span>
<span id="cb129-90"><a href="#cb129-90" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">cache =</span> <span class="cn">TRUE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, </span>
<span id="cb129-91"><a href="#cb129-91" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">cache.lazy =</span> <span class="cn">FALSE</span>)</span>
<span id="cb129-92"><a href="#cb129-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-93"><a href="#cb129-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-94"><a href="#cb129-94" aria-hidden="true" tabindex="-1"></a><span class="fu">## Format .fcs data</span></span>
<span id="cb129-95"><a href="#cb129-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-96"><a href="#cb129-96" aria-hidden="true" tabindex="-1"></a>Before running the analyses, do this to rename all your files using this bash script to add "<span class="sc">\_</span>" if the file name has spaces.</span>
<span id="cb129-97"><a href="#cb129-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-100"><a href="#cb129-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb129-101"><a href="#cb129-101" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: format your files</span></span>
<span id="cb129-102"><a href="#cb129-102" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> facs_data</span>
<span id="cb129-103"><a href="#cb129-103" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> file <span class="kw">in</span> Specimen_<span class="pp">*</span>.fcs<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb129-104"><a href="#cb129-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mv</span> <span class="st">"</span><span class="va">$file</span><span class="st">"</span> <span class="st">"</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$file</span> <span class="kw">|</span> <span class="fu">tr</span> <span class="st">' '</span> <span class="st">'_'</span><span class="va">)</span><span class="st">"</span></span>
<span id="cb129-105"><a href="#cb129-105" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb129-106"><a href="#cb129-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-107"><a href="#cb129-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-108"><a href="#cb129-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-109"><a href="#cb129-109" aria-hidden="true" tabindex="-1"></a>If you want to load only one sample and get to know the details you can do so by using read.FCS function.</span>
<span id="cb129-110"><a href="#cb129-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-111"><a href="#cb129-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=TRUE, results='hide'}</span></span>
<span id="cb129-112"><a href="#cb129-112" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: read single file</span></span>
<span id="cb129-113"><a href="#cb129-113" aria-hidden="true" tabindex="-1"></a><span class="do">## Read one single dataset</span></span>
<span id="cb129-114"><a href="#cb129-114" aria-hidden="true" tabindex="-1"></a><span class="co">#myfile &lt;- "./facs_data/Specimen_001_BRUTTO_MS_016_RZ_HC_del_17-10-22.fcs"</span></span>
<span id="cb129-115"><a href="#cb129-115" aria-hidden="true" tabindex="-1"></a><span class="co">#fcsfile&lt;- read.FCS(myfile, truncate_max_range = FALSE)</span></span>
<span id="cb129-116"><a href="#cb129-116" aria-hidden="true" tabindex="-1"></a><span class="co">#names(fcsfile)#names of the columns</span></span>
<span id="cb129-117"><a href="#cb129-117" aria-hidden="true" tabindex="-1"></a><span class="co">#exprs(fcsfile) #expression values</span></span>
<span id="cb129-118"><a href="#cb129-118" aria-hidden="true" tabindex="-1"></a><span class="co">#each_col(fcsfile, median) #median</span></span>
<span id="cb129-119"><a href="#cb129-119" aria-hidden="true" tabindex="-1"></a><span class="co">#keyword(fcsfile) #metadata</span></span>
<span id="cb129-120"><a href="#cb129-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-121"><a href="#cb129-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-122"><a href="#cb129-122" aria-hidden="true" tabindex="-1"></a><span class="fu">## Read the whole dataset</span></span>
<span id="cb129-123"><a href="#cb129-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-124"><a href="#cb129-124" aria-hidden="true" tabindex="-1"></a>The&nbsp;<span class="in">`read.flowSet`</span>&nbsp;allows you to read many&nbsp;<span class="in">`.fcs`</span>&nbsp;at once. The resultant flowSet object will store the data from all these&nbsp;<span class="in">`.fcs`</span>&nbsp;files.</span>
<span id="cb129-125"><a href="#cb129-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-128"><a href="#cb129-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-129"><a href="#cb129-129" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: read the whole dataset </span></span>
<span id="cb129-130"><a href="#cb129-130" aria-hidden="true" tabindex="-1"></a><span class="co">#check the coloumn names</span></span>
<span id="cb129-131"><a href="#cb129-131" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> <span class="fu">read.flowSet</span>(<span class="at">path =</span> <span class="st">"./facs_data//"</span>, <span class="at">pattern =</span> <span class="st">".fcs"</span>, <span class="at">truncate_max_range =</span> <span class="cn">FALSE</span>, <span class="at">alter.names =</span> T)</span>
<span id="cb129-132"><a href="#cb129-132" aria-hidden="true" tabindex="-1"></a>fs[<span class="dv">1</span>]</span>
<span id="cb129-133"><a href="#cb129-133" aria-hidden="true" tabindex="-1"></a>fs</span>
<span id="cb129-134"><a href="#cb129-134" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(fs[<span class="dv">1</span>])</span>
<span id="cb129-135"><a href="#cb129-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-136"><a href="#cb129-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-137"><a href="#cb129-137" aria-hidden="true" tabindex="-1"></a>#Sample information such as sample names can be accessed with the&nbsp;pData&nbsp;function. So, let's extract the well ID from the sample name.</span>
<span id="cb129-138"><a href="#cb129-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-141"><a href="#cb129-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-142"><a href="#cb129-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: extract metadata</span></span>
<span id="cb129-143"><a href="#cb129-143" aria-hidden="true" tabindex="-1"></a><span class="fu">pData</span>(fs)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb129-144"><a href="#cb129-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Pattern to extract the date, accounting for potential extra text after the date</span></span>
<span id="cb129-145"><a href="#cb129-145" aria-hidden="true" tabindex="-1"></a><span class="fu">pData</span>(fs)<span class="sc">$</span>well <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">".*del_(</span><span class="sc">\\</span><span class="st">d{1,2}-</span><span class="sc">\\</span><span class="st">d{1,2}-</span><span class="sc">\\</span><span class="st">d{2,4}).*?</span><span class="sc">\\</span><span class="st">.fcs"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, <span class="fu">sampleNames</span>(fs))</span>
<span id="cb129-146"><a href="#cb129-146" aria-hidden="true" tabindex="-1"></a><span class="fu">pData</span>(fs)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb129-147"><a href="#cb129-147" aria-hidden="true" tabindex="-1"></a><span class="do">### Understand the abbrebiations/dyes/chemicals used. This is optional</span></span>
<span id="cb129-148"><a href="#cb129-148" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(fs)</span>
<span id="cb129-149"><a href="#cb129-149" aria-hidden="true" tabindex="-1"></a><span class="co">#check parameters data</span></span>
<span id="cb129-150"><a href="#cb129-150" aria-hidden="true" tabindex="-1"></a>fs[[<span class="dv">1</span>]]<span class="sc">@</span>parameters<span class="sc">@</span>data</span>
<span id="cb129-151"><a href="#cb129-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-152"><a href="#cb129-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-153"><a href="#cb129-153" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Abbreviations used</span></span>
<span id="cb129-154"><a href="#cb129-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-155"><a href="#cb129-155" aria-hidden="true" tabindex="-1"></a>The abbreviations are commonly used in flow cytometry. Here's a brief explanation of some of the key terms:</span>
<span id="cb129-156"><a href="#cb129-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-157"><a href="#cb129-157" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**FSC**: Forward Scatter</span>
<span id="cb129-158"><a href="#cb129-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-159"><a href="#cb129-159" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**FSC.A**: Forward Scatter Area</span>
<span id="cb129-160"><a href="#cb129-160" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**FSC.H**: Forward Scatter Height</span>
<span id="cb129-161"><a href="#cb129-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-162"><a href="#cb129-162" aria-hidden="true" tabindex="-1"></a>    Forward scatter is related to the size of the cell. The larger the cell, the more light is scattered in the forward direction.</span>
<span id="cb129-163"><a href="#cb129-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-164"><a href="#cb129-164" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**SSC**: Side Scatter</span>
<span id="cb129-165"><a href="#cb129-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-166"><a href="#cb129-166" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**SSC.A**: Side Scatter Area</span>
<span id="cb129-167"><a href="#cb129-167" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**SSC.H**: Side Scatter Height</span>
<span id="cb129-168"><a href="#cb129-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-169"><a href="#cb129-169" aria-hidden="true" tabindex="-1"></a>    Side scatter reflects the complexity or granularity of the cell. For example, cells with internal structures, like granules, will scatter more light to the side.</span>
<span id="cb129-170"><a href="#cb129-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-171"><a href="#cb129-171" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**FITC**: Fluorescein Isothiocyanate</span>
<span id="cb129-172"><a href="#cb129-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-173"><a href="#cb129-173" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>This is a fluorescent dye used to label cells or components within cells. It's not explicitly listed in your abbreviations, but it's a common fluorochrome in flow cytometry.</span>
<span id="cb129-174"><a href="#cb129-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-175"><a href="#cb129-175" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>The other abbreviations (like "BB515.A", "BB630.A", "BUV395.A", etc.) are likely referring to specific fluorescent markers or dyes used in the analysis. Each of these markers is designed to bind to a specific cell component or molecule and will emit light at a specific wavelength when excited by a laser. The ".A" typically stands for Area, indicating the measurement of the fluorescent signal's area.</span>
<span id="cb129-176"><a href="#cb129-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-177"><a href="#cb129-177" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**APC**: Allophycocyanin</span>
<span id="cb129-178"><a href="#cb129-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-179"><a href="#cb129-179" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**APC.A**: Allophycocyanin Area</span>
<span id="cb129-180"><a href="#cb129-180" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**APC.R700.A**: APC R700 Area</span>
<span id="cb129-181"><a href="#cb129-181" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**APC.H7.A**: APC H7 Area</span>
<span id="cb129-182"><a href="#cb129-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-183"><a href="#cb129-183" aria-hidden="true" tabindex="-1"></a>    APC is another fluorescent dye used in flow cytometry.</span>
<span id="cb129-184"><a href="#cb129-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-185"><a href="#cb129-185" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>**PE**: Phycoerythrin</span>
<span id="cb129-186"><a href="#cb129-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-187"><a href="#cb129-187" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**PE.CF594.A**: Phycoerythrin CF594 Area</span>
<span id="cb129-188"><a href="#cb129-188" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**PE.Cy5.A**: Phycoerythrin Cy5 Area</span>
<span id="cb129-189"><a href="#cb129-189" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**PE.Cy7.A**: Phycoerythrin Cy7 Area</span>
<span id="cb129-190"><a href="#cb129-190" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**PE.A**: Phycoerythrin Area</span>
<span id="cb129-191"><a href="#cb129-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-192"><a href="#cb129-192" aria-hidden="true" tabindex="-1"></a>    PE is a bright fluorescent dye commonly used in flow cytometry.</span>
<span id="cb129-193"><a href="#cb129-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-194"><a href="#cb129-194" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>**BV**: Brilliant Violet</span>
<span id="cb129-195"><a href="#cb129-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-196"><a href="#cb129-196" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The numbers following "BV" (like in "BV421.A", "BV510.A", etc.) refer to different variants of the Brilliant Violet dye, each with a specific emission spectrum.</span>
<span id="cb129-197"><a href="#cb129-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-198"><a href="#cb129-198" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>**Time**: This usually refers to the time parameter, indicating the duration of the cell's passage through the laser beam, which can be useful for identifying doublets or aggregates.</span>
<span id="cb129-199"><a href="#cb129-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-200"><a href="#cb129-200" aria-hidden="true" tabindex="-1"></a>Each of these parameters provides different information about the cells being analyzed, allowing for detailed characterization of cell populations based on size, granularity, and the presence of specific markers or dyes.</span>
<span id="cb129-201"><a href="#cb129-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-204"><a href="#cb129-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-205"><a href="#cb129-205" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: renaming some markers</span></span>
<span id="cb129-206"><a href="#cb129-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span><span class="al">###</span><span class="co"> If you want to change your column names(optional)</span></span>
<span id="cb129-207"><a href="#cb129-207" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(fs)</span>
<span id="cb129-208"><a href="#cb129-208" aria-hidden="true" tabindex="-1"></a>fs[[<span class="dv">1</span>]]<span class="sc">@</span>parameters<span class="sc">@</span>data</span>
<span id="cb129-209"><a href="#cb129-209" aria-hidden="true" tabindex="-1"></a><span class="co">#If you want to change certain namings then use this. Just an example. You can change accordingly for your observations/experiment</span></span>
<span id="cb129-210"><a href="#cb129-210" aria-hidden="true" tabindex="-1"></a><span class="co">#colnames(fs)[colnames(fs) == "BB660.P.A"] &lt;- "BB660.P"</span></span>
<span id="cb129-211"><a href="#cb129-211" aria-hidden="true" tabindex="-1"></a><span class="co">#colnames(fs)[colnames(fs) == "BB755.P.A"] &lt;- "BB755.P"</span></span>
<span id="cb129-212"><a href="#cb129-212" aria-hidden="true" tabindex="-1"></a><span class="co">#colnames(fs)[colnames(fs) == "BB790.P.A"] &lt;- "BB790.P"</span></span>
<span id="cb129-213"><a href="#cb129-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-214"><a href="#cb129-214" aria-hidden="true" tabindex="-1"></a><span class="co">#If you want to change certain namings then use this</span></span>
<span id="cb129-215"><a href="#cb129-215" aria-hidden="true" tabindex="-1"></a><span class="co">#colnames(fs)[colnames(fs)=="FSC.A"] &lt;- "FSC"</span></span>
<span id="cb129-216"><a href="#cb129-216" aria-hidden="true" tabindex="-1"></a><span class="co">#colnames(fs)[colnames(fs)=="PE.CF594.A"] &lt;- "Phycoerythrin"</span></span>
<span id="cb129-217"><a href="#cb129-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-218"><a href="#cb129-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-219"><a href="#cb129-219" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compensate your sample manually</span></span>
<span id="cb129-220"><a href="#cb129-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-221"><a href="#cb129-221" aria-hidden="true" tabindex="-1"></a>The&nbsp;**Spillover Spreading Matrix**&nbsp;(SSM) values have been demonstrated to reveal fluorescence spectrum interactions that can limit the sensitivity of a reagent in the presence of brightly-stained cells on a different color. The SSM can thus be a useful tool in instrument quality control to ensure consistent sensitivity and performance. In addition, the SSM is a key element for predicting multicolor immunofluorescence panels, which will aid in the optimization and development of new panels.</span>
<span id="cb129-222"><a href="#cb129-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-223"><a href="#cb129-223" aria-hidden="true" tabindex="-1"></a>TheSpillover Spreading Matrix&nbsp;page is automatically created by FCS Express when either the Compensation or the Unmixing Matrix is calculated and depicts a spreadsheet with the Spillover Spreading values for every pair of dyes included in the compensation/unmixing matrix respectively.</span>
<span id="cb129-224"><a href="#cb129-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-225"><a href="#cb129-225" aria-hidden="true" tabindex="-1"></a>Compensating flow cytometry data is an essential step in the analysis of multicolor panels. It corrects for the overlap of fluorescent signals between different channels. The output you provided looks like it's from an FCS file, showing various parameters like forward scatter (FSC), side scatter (SSC), and different fluorochromes associated with specific markers (e.g., CD24, IgD, CD56).</span>
<span id="cb129-226"><a href="#cb129-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-227"><a href="#cb129-227" aria-hidden="true" tabindex="-1"></a>To properly compensate your FCS files, you typically need the following:</span>
<span id="cb129-228"><a href="#cb129-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-229"><a href="#cb129-229" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Unstained Control:** A sample that has cells (or beads) without any fluorescent labels. This control helps you set the baseline for autofluorescence.</span>
<span id="cb129-230"><a href="#cb129-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-231"><a href="#cb129-231" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Single-Color Controls:** These are samples where each cell (or bead) is stained with only one fluorochrome at a time. These controls are crucial for compensation as they show the extent of spectral overlap into other channels.</span>
<span id="cb129-232"><a href="#cb129-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-233"><a href="#cb129-233" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Compensation Software or Tools:** Most flow cytometry software comes with built-in compensation tools. These tools use the single-color controls to calculate compensation matrices, which are then applied to your experimental data.</span>
<span id="cb129-234"><a href="#cb129-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-235"><a href="#cb129-235" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Experimental Data:** Your actual samples that have been stained with multiple fluorochromes.</span>
<span id="cb129-236"><a href="#cb129-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-237"><a href="#cb129-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=TRUE, results='hide'}</span></span>
<span id="cb129-238"><a href="#cb129-238" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compensation using control sample</span></span>
<span id="cb129-239"><a href="#cb129-239" aria-hidden="true" tabindex="-1"></a><span class="co">#compensate using 1st sample assuming you know the control</span></span>
<span id="cb129-240"><a href="#cb129-240" aria-hidden="true" tabindex="-1"></a><span class="fu">spillover</span>(fs[[<span class="dv">1</span>]])</span>
<span id="cb129-241"><a href="#cb129-241" aria-hidden="true" tabindex="-1"></a>fs_comp <span class="ot">&lt;-</span><span class="fu">compensate</span>(fs, <span class="fu">spillover</span>(fs[[<span class="dv">1</span>]])<span class="sc">$</span>SPILL)</span>
<span id="cb129-242"><a href="#cb129-242" aria-hidden="true" tabindex="-1"></a>fs_comp[[<span class="dv">1</span>]]<span class="sc">@</span>parameters<span class="sc">@</span>data</span>
<span id="cb129-243"><a href="#cb129-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-244"><a href="#cb129-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-245"><a href="#cb129-245" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quality check</span></span>
<span id="cb129-246"><a href="#cb129-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-247"><a href="#cb129-247" aria-hidden="true" tabindex="-1"></a>It will create a folder with quality control html files.</span>
<span id="cb129-248"><a href="#cb129-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-249"><a href="#cb129-249" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Flow Rate Check (33.3% of anomalous cells detected):**</span>
<span id="cb129-250"><a href="#cb129-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-251"><a href="#cb129-251" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>This check assesses whether cells are passing through the flow cytometer at an appropriate rate. An optimal flow rate is crucial for accurate data collection.</span>
<span id="cb129-252"><a href="#cb129-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-253"><a href="#cb129-253" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Anomalies here could be due to issues like clumping of cells, clogging in the flow cell, or incorrect flow rate settings, leading to inconsistent cell counts or data.</span>
<span id="cb129-254"><a href="#cb129-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-255"><a href="#cb129-255" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A high percentage of anomalous cells in this check suggests that a significant portion of the sample may have been analyzed under suboptimal flow conditions.</span>
<span id="cb129-256"><a href="#cb129-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-257"><a href="#cb129-257" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Signal Acquisition Check (31.05% of anomalous cells detected):**</span>
<span id="cb129-258"><a href="#cb129-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-259"><a href="#cb129-259" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>This pertains to the detection and measurement of the fluorescence and scatter signals from the cells.</span>
<span id="cb129-260"><a href="#cb129-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-261"><a href="#cb129-261" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Anomalies in signal acquisition can arise from issues like inadequate staining, photobleaching, detector malfunction, or electronic noise.</span>
<span id="cb129-262"><a href="#cb129-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-263"><a href="#cb129-263" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A substantial proportion of cells with anomalous signal acquisition can lead to inaccurate fluorescence intensity measurements, affecting the interpretation of the data.</span>
<span id="cb129-264"><a href="#cb129-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-265"><a href="#cb129-265" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Dynamic Range Check (49.95% of anomalous cells detected):**</span>
<span id="cb129-266"><a href="#cb129-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-267"><a href="#cb129-267" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The dynamic range check evaluates whether the fluorescence intensities of the cells fall within the detectable range of the cytometer.</span>
<span id="cb129-268"><a href="#cb129-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-269"><a href="#cb129-269" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Cells outside this range can either be too dim (below detection limit) or too bright (causing signal saturation), both of which can skew data interpretation.</span>
<span id="cb129-270"><a href="#cb129-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-271"><a href="#cb129-271" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A high percentage in this category could mean that a large portion of your cells are either too dim or too bright for accurate measurement, possibly due to over- or under-staining, or issues with the cytometer settings.</span>
<span id="cb129-272"><a href="#cb129-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-275"><a href="#cb129-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-276"><a href="#cb129-276" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Quality Check of samples</span></span>
<span id="cb129-277"><a href="#cb129-277" aria-hidden="true" tabindex="-1"></a><span class="co">#QC</span></span>
<span id="cb129-278"><a href="#cb129-278" aria-hidden="true" tabindex="-1"></a><span class="co">#flow_auto_qc(fs_comp)</span></span>
<span id="cb129-279"><a href="#cb129-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-280"><a href="#cb129-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-281"><a href="#cb129-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## Transformation</span></span>
<span id="cb129-282"><a href="#cb129-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-283"><a href="#cb129-283" aria-hidden="true" tabindex="-1"></a>Transforming flow cytometry data after compensation is a common and important step in the analysis process. Compensation corrects for spectral overlap between different fluorochromes, but it doesn't address the issue of data distribution. Flow cytometry data, especially fluorescence intensity, often exhibits a positively skewed distribution. Transformations like log or biexponential (logicle) are used to convert this skewed data into a more normally distributed form, which is easier to analyze and interpret.</span>
<span id="cb129-284"><a href="#cb129-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-287"><a href="#cb129-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-288"><a href="#cb129-288" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: transformation</span></span>
<span id="cb129-289"><a href="#cb129-289" aria-hidden="true" tabindex="-1"></a><span class="co">#Transformation</span></span>
<span id="cb129-290"><a href="#cb129-290" aria-hidden="true" tabindex="-1"></a>fs_comp[[<span class="dv">1</span>]]<span class="sc">@</span>parameters<span class="sc">@</span>data</span>
<span id="cb129-291"><a href="#cb129-291" aria-hidden="true" tabindex="-1"></a>trans <span class="ot">&lt;-</span> <span class="fu">estimateLogicle</span>(fs_comp[[<span class="dv">1</span>]], <span class="fu">colnames</span>(fs_comp[[<span class="dv">1</span>]][,<span class="dv">5</span><span class="sc">:</span><span class="dv">32</span>]))</span>
<span id="cb129-292"><a href="#cb129-292" aria-hidden="true" tabindex="-1"></a>fs_comp_clean_trans <span class="ot">&lt;-</span> <span class="fu">transform</span>(fs_comp, trans)</span>
<span id="cb129-293"><a href="#cb129-293" aria-hidden="true" tabindex="-1"></a>fs_comp_clean_trans[[<span class="dv">1</span>]]</span>
<span id="cb129-294"><a href="#cb129-294" aria-hidden="true" tabindex="-1"></a>fs_comp_clean_trans[[<span class="dv">1</span>]]<span class="sc">@</span>parameters<span class="sc">@</span>data</span>
<span id="cb129-295"><a href="#cb129-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-296"><a href="#cb129-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-297"><a href="#cb129-297" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visulaize the results using ggcyto</span></span>
<span id="cb129-298"><a href="#cb129-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-301"><a href="#cb129-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-302"><a href="#cb129-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compare the plots</span></span>
<span id="cb129-303"><a href="#cb129-303" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fs_comp[[<span class="dv">1</span>]])</span>
<span id="cb129-304"><a href="#cb129-304" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fs_comp_clean_trans[[<span class="dv">1</span>]])</span>
<span id="cb129-305"><a href="#cb129-305" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fs_comp, <span class="at">x=</span><span class="st">"FSC.A"</span>, <span class="at">y=</span><span class="st">"SSC.A"</span>, <span class="at">bins =</span> <span class="dv">256</span>)<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span> well)</span>
<span id="cb129-306"><a href="#cb129-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-307"><a href="#cb129-307" aria-hidden="true" tabindex="-1"></a><span class="co">#visualization with other marker</span></span>
<span id="cb129-308"><a href="#cb129-308" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fs_comp_clean_trans, <span class="at">x=</span><span class="st">"FSC.A"</span>, <span class="at">y=</span><span class="st">"PE.CF594.A"</span>, <span class="at">bins =</span> <span class="dv">256</span>)<span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> well)</span>
<span id="cb129-309"><a href="#cb129-309" aria-hidden="true" tabindex="-1"></a><span class="co">#visualization with time</span></span>
<span id="cb129-310"><a href="#cb129-310" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fs_comp_clean_trans, <span class="at">x=</span><span class="st">"Time"</span>, <span class="at">y=</span><span class="st">"FSC.A"</span>, <span class="at">bins =</span> <span class="dv">256</span>)<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span> well)</span>
<span id="cb129-311"><a href="#cb129-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-312"><a href="#cb129-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-313"><a href="#cb129-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-314"><a href="#cb129-314" aria-hidden="true" tabindex="-1"></a><span class="fu">## GatingSet</span></span>
<span id="cb129-315"><a href="#cb129-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-316"><a href="#cb129-316" aria-hidden="true" tabindex="-1"></a><span class="fu">### **What is Gating in Flow Cytometry?**</span></span>
<span id="cb129-317"><a href="#cb129-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-318"><a href="#cb129-318" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Cell Population Identification**: Gating is used to identify and isolate specific subpopulations of cells from a heterogeneous mixture. Flow cytometry can analyze thousands to millions of cells in a single run, and these cells can vary in size, granularity, and fluorescence. Gating allows researchers to focus on specific cells of interest based on these characteristics.</span>
<span id="cb129-319"><a href="#cb129-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-320"><a href="#cb129-320" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Noise Reduction**: It helps in eliminating debris, dead cells, and aggregates, which are not relevant to the analysis. This cleaning up of data is crucial for accurate results.</span>
<span id="cb129-321"><a href="#cb129-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-322"><a href="#cb129-322" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Analysis Simplification**: By isolating specific cell populations, gating simplifies the analysis. It's easier to study and interpret the characteristics of a homogenous population than a heterogeneous one.</span>
<span id="cb129-323"><a href="#cb129-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-324"><a href="#cb129-324" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Quantitative Analysis**: Gating enables quantitative analysis of cell populations. Researchers can determine the percentage of cells expressing a particular marker, the intensity of expression, and other quantitative metrics.</span>
<span id="cb129-325"><a href="#cb129-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-326"><a href="#cb129-326" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Sequential Gating**: Often, gating is a multi-step process where one gate is applied to isolate a broad population, and subsequent gates are used to progressively narrow down to more specific cell types.</span>
<span id="cb129-327"><a href="#cb129-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-328"><a href="#cb129-328" aria-hidden="true" tabindex="-1"></a><span class="fu">### **Why Transform `flowSet` to `GatingSet`?**</span></span>
<span id="cb129-329"><a href="#cb129-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-330"><a href="#cb129-330" aria-hidden="true" tabindex="-1"></a>In R, the transformation of a **`flowSet`** object to a **`GatingSet`** object is a critical step for gating:</span>
<span id="cb129-331"><a href="#cb129-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-332"><a href="#cb129-332" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Structure Adaptation**: **`flowSet`** is a collection of flow cytometry samples (FCS files). To apply gating, this data needs to be in a format that can be interacted with gating tools. **`GatingSet`** provides this structure.</span>
<span id="cb129-333"><a href="#cb129-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-334"><a href="#cb129-334" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Gating Tools Compatibility**: **`GatingSet`** is compatible with various gating tools and functions in R. It allows for the application of both manual and automated gating strategies.</span>
<span id="cb129-335"><a href="#cb129-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-336"><a href="#cb129-336" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Efficient Handling of Data**: **`GatingSet`** objects are designed to handle large datasets efficiently, making them suitable for high-throughput data.</span>
<span id="cb129-337"><a href="#cb129-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-338"><a href="#cb129-338" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Integration with Visualization Tools**: Once the data is in a **`GatingSet`**, it can be easily visualized using tools like **`ggcyto`**, allowing for the visual assessment of gates and the populations they isolate.</span>
<span id="cb129-339"><a href="#cb129-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-340"><a href="#cb129-340" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Data Integrity**: Transforming to a **`GatingSet`** ensures that the integrity of the original data is maintained while allowing for the sophisticated manipulation needed for gating.</span>
<span id="cb129-341"><a href="#cb129-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-342"><a href="#cb129-342" aria-hidden="true" tabindex="-1"></a>To be able to add gates, the flowSet has to be transformed to a GatingSet object with the&nbsp;<span class="in">`GatingSet`</span>&nbsp;function</span>
<span id="cb129-343"><a href="#cb129-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-346"><a href="#cb129-346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-347"><a href="#cb129-347" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">GatingSet</span>(fs_comp_clean_trans)</span>
<span id="cb129-348"><a href="#cb129-348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-349"><a href="#cb129-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-352"><a href="#cb129-352" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-353"><a href="#cb129-353" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cell gating</span></span>
<span id="cb129-354"><a href="#cb129-354" aria-hidden="true" tabindex="-1"></a><span class="co">#cell gate</span></span>
<span id="cb129-355"><a href="#cb129-355" aria-hidden="true" tabindex="-1"></a>fs_data<span class="ot">&lt;-</span> <span class="fu">gs_pop_get_data</span>(gs)</span>
<span id="cb129-356"><a href="#cb129-356" aria-hidden="true" tabindex="-1"></a>my_gate<span class="ot">&lt;-</span> <span class="fu">fsApply</span>(fs_data, <span class="cf">function</span>(fr) openCyto<span class="sc">:::</span><span class="fu">.flowClust.2d</span>(fr, <span class="at">channels=</span> <span class="fu">c</span>(<span class="st">"FSC.A"</span>,<span class="st">"SSC.A"</span>)))</span>
<span id="cb129-357"><a href="#cb129-357" aria-hidden="true" tabindex="-1"></a><span class="fu">gs_pop_add</span>(gs, my_gate, <span class="at">parent =</span> <span class="st">"root"</span>, <span class="at">name=</span><span class="st">"my_gate"</span>)</span>
<span id="cb129-358"><a href="#cb129-358" aria-hidden="true" tabindex="-1"></a><span class="fu">recompute</span>(gs)</span>
<span id="cb129-359"><a href="#cb129-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-360"><a href="#cb129-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-363"><a href="#cb129-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-364"><a href="#cb129-364" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: plot each set</span></span>
<span id="cb129-365"><a href="#cb129-365" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gs)) {</span>
<span id="cb129-366"><a href="#cb129-366" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate the plot for each sample</span></span>
<span id="cb129-367"><a href="#cb129-367" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(gs[[i]], <span class="at">x=</span><span class="st">"FSC.A"</span>, <span class="at">y=</span><span class="st">"SSC.A"</span>, <span class="st">"my_gate"</span>, <span class="at">bins=</span><span class="dv">256</span>)</span>
<span id="cb129-368"><a href="#cb129-368" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-369"><a href="#cb129-369" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the plot</span></span>
<span id="cb129-370"><a href="#cb129-370" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(p)</span>
<span id="cb129-371"><a href="#cb129-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-372"><a href="#cb129-372" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Optionally, you can save each plot to a file</span></span>
<span id="cb129-373"><a href="#cb129-373" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ggsave(filename=paste("plot_", i, ".png", sep=""), plot=p)</span></span>
<span id="cb129-374"><a href="#cb129-374" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb129-375"><a href="#cb129-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-376"><a href="#cb129-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-379"><a href="#cb129-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-380"><a href="#cb129-380" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup single gate</span></span>
<span id="cb129-381"><a href="#cb129-381" aria-hidden="true" tabindex="-1"></a><span class="co">#cell gate</span></span>
<span id="cb129-382"><a href="#cb129-382" aria-hidden="true" tabindex="-1"></a><span class="co">#Singlet gate</span></span>
<span id="cb129-383"><a href="#cb129-383" aria-hidden="true" tabindex="-1"></a>fs_data <span class="ot">&lt;-</span> <span class="fu">gs_pop_get_data</span>(gs, <span class="st">"my_gate"</span>) <span class="co">#get parent data</span></span>
<span id="cb129-384"><a href="#cb129-384" aria-hidden="true" tabindex="-1"></a>singlet_gate <span class="ot">&lt;-</span> <span class="fu">fsApply</span>(fs_data, <span class="cf">function</span>(fr) openCyto<span class="sc">:::</span><span class="fu">.singletGate</span>(fr, <span class="at">channels =</span><span class="fu">c</span>(<span class="st">"FSC.A"</span>, <span class="st">"FSC.H"</span>)))</span>
<span id="cb129-385"><a href="#cb129-385" aria-hidden="true" tabindex="-1"></a><span class="fu">gs_pop_add</span>(gs, singlet_gate, <span class="at">parent =</span> <span class="st">"my_gate"</span>, <span class="at">name =</span> <span class="st">"singlets"</span>)</span>
<span id="cb129-386"><a href="#cb129-386" aria-hidden="true" tabindex="-1"></a><span class="fu">recompute</span>(gs)</span>
<span id="cb129-387"><a href="#cb129-387" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(gs, <span class="at">x =</span> <span class="st">'FSC.A'</span>, <span class="at">y =</span> <span class="st">'FSC.H'</span>, <span class="st">"singlets"</span>, <span class="at">bins =</span> <span class="dv">256</span>)</span>
<span id="cb129-388"><a href="#cb129-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-389"><a href="#cb129-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-390"><a href="#cb129-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-393"><a href="#cb129-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-394"><a href="#cb129-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: plot each set of single gate</span></span>
<span id="cb129-395"><a href="#cb129-395" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gs)) {</span>
<span id="cb129-396"><a href="#cb129-396" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate the plot for each sample</span></span>
<span id="cb129-397"><a href="#cb129-397" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(gs[[i]], <span class="at">x=</span><span class="st">"FSC.A"</span>, <span class="at">y=</span><span class="st">"FSC.H"</span>, <span class="st">"singlets"</span>, <span class="at">bins=</span><span class="dv">256</span>)</span>
<span id="cb129-398"><a href="#cb129-398" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-399"><a href="#cb129-399" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the plot</span></span>
<span id="cb129-400"><a href="#cb129-400" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(p)</span>
<span id="cb129-401"><a href="#cb129-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-402"><a href="#cb129-402" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Optionally, you can save each plot to a file</span></span>
<span id="cb129-403"><a href="#cb129-403" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ggsave(filename=paste("plot_", i, ".png", sep=""), plot=p)</span></span>
<span id="cb129-404"><a href="#cb129-404" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb129-405"><a href="#cb129-405" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-406"><a href="#cb129-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-407"><a href="#cb129-407" aria-hidden="true" tabindex="-1"></a>Quad gate (optional)</span>
<span id="cb129-408"><a href="#cb129-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-411"><a href="#cb129-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-412"><a href="#cb129-412" aria-hidden="true" tabindex="-1"></a><span class="co">#Quad gate (optional)</span></span>
<span id="cb129-413"><a href="#cb129-413" aria-hidden="true" tabindex="-1"></a><span class="co">#fs_comp_clean_trans[[1]]@parameters@data</span></span>
<span id="cb129-414"><a href="#cb129-414" aria-hidden="true" tabindex="-1"></a><span class="co">#fs_data &lt;- gs_pop_get_data(gs, "singlets") #get parent data</span></span>
<span id="cb129-415"><a href="#cb129-415" aria-hidden="true" tabindex="-1"></a><span class="co">#BGquad_gate &lt;- fsApply(fs_data, function(fr) openCyto:::.quadGate.seq(fr, gFunc="mindensity", min=c(3,3), channels =c('BUV737.A', 'BUV805.A')))</span></span>
<span id="cb129-416"><a href="#cb129-416" aria-hidden="true" tabindex="-1"></a><span class="co">#gs_pop_add(gs, BGquad_gate, parent = "singlets", names = c("1", "2", "3", "4"))</span></span>
<span id="cb129-417"><a href="#cb129-417" aria-hidden="true" tabindex="-1"></a><span class="co">#recompute(gs)</span></span>
<span id="cb129-418"><a href="#cb129-418" aria-hidden="true" tabindex="-1"></a><span class="co">#gs_get_pop_paths(gs[[1]])</span></span>
<span id="cb129-419"><a href="#cb129-419" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(gs)</span></span>
<span id="cb129-420"><a href="#cb129-420" aria-hidden="true" tabindex="-1"></a><span class="co">#autoplot(gs, x = 'BUV737.A', y = 'BUV805.A', gs_get_pop_paths(auto_gs)[5:32], bins = 256)</span></span>
<span id="cb129-421"><a href="#cb129-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-422"><a href="#cb129-422" aria-hidden="true" tabindex="-1"></a><span class="co">#fix plot</span></span>
<span id="cb129-423"><a href="#cb129-423" aria-hidden="true" tabindex="-1"></a><span class="co">#p&lt;-ggcyto(auto_gs[1:2],aes(x = 'X.BUV737.A', y = 'BUV805.A'), subset="singlets", arrange = FALSE)</span></span>
<span id="cb129-424"><a href="#cb129-424" aria-hidden="true" tabindex="-1"></a><span class="co">#p&lt;- p + geom_hex(bins=256)</span></span>
<span id="cb129-425"><a href="#cb129-425" aria-hidden="true" tabindex="-1"></a><span class="co">#p&lt;- p + geom_gate(gs_get_pop_paths(auto_gs)[5:32]) </span></span>
<span id="cb129-426"><a href="#cb129-426" aria-hidden="true" tabindex="-1"></a><span class="co">#p&lt;- p + geom_stats(gs_get_pop_paths(auto_gs)[5:32])</span></span>
<span id="cb129-427"><a href="#cb129-427" aria-hidden="true" tabindex="-1"></a><span class="co">#p&lt;- p + theme(strip.text = element_text(size = 7))</span></span>
<span id="cb129-428"><a href="#cb129-428" aria-hidden="true" tabindex="-1"></a><span class="co">#myPars &lt;- ggcyto_par_set(limits = list(y = c(3,5), x = c(3,5)))</span></span>
<span id="cb129-429"><a href="#cb129-429" aria-hidden="true" tabindex="-1"></a><span class="co">#p&lt;- p  + myPars</span></span>
<span id="cb129-430"><a href="#cb129-430" aria-hidden="true" tabindex="-1"></a><span class="co">#p</span></span>
<span id="cb129-431"><a href="#cb129-431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-432"><a href="#cb129-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-433"><a href="#cb129-433" aria-hidden="true" tabindex="-1"></a><span class="fu">## Statistics</span></span>
<span id="cb129-434"><a href="#cb129-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-435"><a href="#cb129-435" aria-hidden="true" tabindex="-1"></a><span class="fu">### **`gs_pop_get_stats(gs)`**</span></span>
<span id="cb129-436"><a href="#cb129-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-437"><a href="#cb129-437" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Purpose**: This command retrieves basic statistical information for all cell populations in the **`GatingSet`**.</span>
<span id="cb129-438"><a href="#cb129-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-439"><a href="#cb129-439" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Importance**: It provides an overview of the cell populations identified by gating, including counts and percentages, which are fundamental for understanding the composition of your sample.</span>
<span id="cb129-440"><a href="#cb129-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-441"><a href="#cb129-441" aria-hidden="true" tabindex="-1"></a><span class="fu">### **2. `gs_pop_get_stats(gs, "my_gate", "percent")`**</span></span>
<span id="cb129-442"><a href="#cb129-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-443"><a href="#cb129-443" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Purpose**: This retrieves the percentage of cells in a specific gate (**`"my_gate"`**) relative to the parent population.</span>
<span id="cb129-444"><a href="#cb129-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-445"><a href="#cb129-445" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Importance**: Understanding the proportion of a specific cell population (e.g., a particular type of immune cell) is crucial in many biological and medical contexts, such as determining the prevalence of a cell type in a disease state.</span>
<span id="cb129-446"><a href="#cb129-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-447"><a href="#cb129-447" aria-hidden="true" tabindex="-1"></a><span class="fu">### **3. `gs_pop_get_stats(gs, "my_gate", type = pop.MFI)`**</span></span>
<span id="cb129-448"><a href="#cb129-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-449"><a href="#cb129-449" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Purpose**: Retrieves the Mean Fluorescence Intensity (MFI) for the population in **`"my_gate"`**.</span>
<span id="cb129-450"><a href="#cb129-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-451"><a href="#cb129-451" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Importance**: MFI is a measure of the average fluorescence intensity of a cell population, indicating the level of expression of a fluorescent marker. This is particularly important in assessing the expression levels of proteins of interest, like receptors or antigens on cell surfaces.</span>
<span id="cb129-452"><a href="#cb129-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-453"><a href="#cb129-453" aria-hidden="true" tabindex="-1"></a><span class="fu">### **4. `gs_pop_get_stats(gs, gs_get_pop_paths(gs), type = pop.quantiles)`**</span></span>
<span id="cb129-454"><a href="#cb129-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-455"><a href="#cb129-455" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Custom Function**: **`pop.quantiles`** calculates the 75th percentile (or any other specified quantile) for each channel.</span>
<span id="cb129-456"><a href="#cb129-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-457"><a href="#cb129-457" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Purpose**: This command applies the custom **`pop.quantiles`** function to each gated population.</span>
<span id="cb129-458"><a href="#cb129-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-459"><a href="#cb129-459" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Importance**: Quantiles provide insights into the distribution of fluorescence intensities, which can be critical for understanding variability within cell populations and for identifying subpopulations with higher or lower marker expression.</span>
<span id="cb129-460"><a href="#cb129-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-461"><a href="#cb129-461" aria-hidden="true" tabindex="-1"></a><span class="fu">### **5. `gs_pop_get_stats(gs, gs_get_pop_paths(gs), type = pop.mean)`**</span></span>
<span id="cb129-462"><a href="#cb129-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-463"><a href="#cb129-463" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Custom Function**: **`pop.mean`** calculates the mean of each channel.</span>
<span id="cb129-464"><a href="#cb129-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-465"><a href="#cb129-465" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Purpose**: Applies the custom **`pop.mean`** function to each gated population.</span>
<span id="cb129-466"><a href="#cb129-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-467"><a href="#cb129-467" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Importance**: The mean is a basic statistical measure that provides an average value for fluorescence intensity or other parameters across a cell population. This is useful for comparing the overall expression levels of markers across different samples or conditions.</span>
<span id="cb129-468"><a href="#cb129-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-471"><a href="#cb129-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-472"><a href="#cb129-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: statistics</span></span>
<span id="cb129-473"><a href="#cb129-473" aria-hidden="true" tabindex="-1"></a><span class="co">#statistics</span></span>
<span id="cb129-474"><a href="#cb129-474" aria-hidden="true" tabindex="-1"></a><span class="fu">gs_pop_get_stats</span>(gs)</span>
<span id="cb129-475"><a href="#cb129-475" aria-hidden="true" tabindex="-1"></a><span class="fu">gs_pop_get_stats</span>(gs, <span class="st">"my_gate"</span>, <span class="st">"percent"</span>)</span>
<span id="cb129-476"><a href="#cb129-476" aria-hidden="true" tabindex="-1"></a><span class="fu">gs_pop_get_stats</span>(gs, <span class="st">"my_gate"</span>, <span class="at">type =</span> pop.MFI)</span>
<span id="cb129-477"><a href="#cb129-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-478"><a href="#cb129-478" aria-hidden="true" tabindex="-1"></a>pop.quantiles <span class="ot">&lt;-</span> <span class="cf">function</span>(fr){</span>
<span id="cb129-479"><a href="#cb129-479" aria-hidden="true" tabindex="-1"></a>  chnls <span class="ot">&lt;-</span> <span class="fu">colnames</span>(fr)</span>
<span id="cb129-480"><a href="#cb129-480" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> matrixStats<span class="sc">::</span><span class="fu">colQuantiles</span>(<span class="fu">exprs</span>(fr), <span class="at">probs =</span> <span class="fl">0.75</span>)</span>
<span id="cb129-481"><a href="#cb129-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(res) <span class="ot">&lt;-</span> chnls</span>
<span id="cb129-482"><a href="#cb129-482" aria-hidden="true" tabindex="-1"></a>  res</span>
<span id="cb129-483"><a href="#cb129-483" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb129-484"><a href="#cb129-484" aria-hidden="true" tabindex="-1"></a><span class="fu">gs_pop_get_stats</span>(gs, <span class="fu">gs_get_pop_paths</span>(gs), <span class="at">type =</span> pop.quantiles)</span>
<span id="cb129-485"><a href="#cb129-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-486"><a href="#cb129-486" aria-hidden="true" tabindex="-1"></a>pop.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(fr){</span>
<span id="cb129-487"><a href="#cb129-487" aria-hidden="true" tabindex="-1"></a>  chnls <span class="ot">&lt;-</span> <span class="fu">colnames</span>(fr)</span>
<span id="cb129-488"><a href="#cb129-488" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(<span class="fu">exprs</span>(fr))</span>
<span id="cb129-489"><a href="#cb129-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(res) <span class="ot">&lt;-</span> chnls</span>
<span id="cb129-490"><a href="#cb129-490" aria-hidden="true" tabindex="-1"></a>  res</span>
<span id="cb129-491"><a href="#cb129-491" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb129-492"><a href="#cb129-492" aria-hidden="true" tabindex="-1"></a><span class="fu">gs_pop_get_stats</span>(gs, <span class="fu">gs_get_pop_paths</span>(gs), <span class="at">type =</span> pop.mean)</span>
<span id="cb129-493"><a href="#cb129-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-494"><a href="#cb129-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-495"><a href="#cb129-495" aria-hidden="true" tabindex="-1"></a><span class="fu">## Get populations stats for downstream analysis</span></span>
<span id="cb129-496"><a href="#cb129-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-497"><a href="#cb129-497" aria-hidden="true" tabindex="-1"></a>To get the data from each gating step from the&nbsp;<span class="in">`GatingSet`</span>, we can use the&nbsp;<span class="in">`gs_pop_get_count_with_meta`</span>function (which conveniently also retrieves all the metadata and sample names you might have added).</span>
<span id="cb129-498"><a href="#cb129-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-499"><a href="#cb129-499" aria-hidden="true" tabindex="-1"></a>Stats:</span>
<span id="cb129-500"><a href="#cb129-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-501"><a href="#cb129-501" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Count:** This is the number of events (e.g., cells or particles) that fall within a specific gate in a flow cytometry experiment. In the context of flow cytometry, "events" typically mean individual cells that have been detected and recorded by the cytometer.</span>
<span id="cb129-502"><a href="#cb129-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-503"><a href="#cb129-503" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ParentCount:** This refers to the number of events in the parent population from which a subset (child gate) was derived. In gating hierarchies, you often start with a broad population (like all detected events) and apply gates to sequentially narrow down to specific populations of interest. The "ParentCount" is the count of the broader population before the more specific gate was applied.</span>
<span id="cb129-504"><a href="#cb129-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-505"><a href="#cb129-505" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**percent_of_parent:** This is a calculated field that represents the proportion of events in a specific gate relative to the parent population. It's calculated by dividing the "Count" by the "ParentCount" and typically expressed as a percentage. This gives you an idea of how many cells from the original parent population fall into a more specific category defined by your gating strategy.</span>
<span id="cb129-506"><a href="#cb129-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-509"><a href="#cb129-509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-510"><a href="#cb129-510" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Get populations stats for downstream analysis</span></span>
<span id="cb129-511"><a href="#cb129-511" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">gs_pop_get_count_with_meta</span>(gs)</span>
<span id="cb129-512"><a href="#cb129-512" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> ps <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">percent_of_parent=</span>Count<span class="sc">/</span>ParentCount)</span>
<span id="cb129-513"><a href="#cb129-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-514"><a href="#cb129-514" aria-hidden="true" tabindex="-1"></a>styled_table <span class="ot">&lt;-</span> ps <span class="sc">%&gt;%</span></span>
<span id="cb129-515"><a href="#cb129-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sampleName, well, Population, Count, ParentCount, percent_of_parent) <span class="sc">%&gt;%</span></span>
<span id="cb129-516"><a href="#cb129-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-517"><a href="#cb129-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">cell_spec</span>(.x, <span class="at">background =</span> <span class="st">"black"</span>, <span class="at">color =</span> <span class="st">"white"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb129-518"><a href="#cb129-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="st">"html"</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-519"><a href="#cb129-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> F)</span>
<span id="cb129-520"><a href="#cb129-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-521"><a href="#cb129-521" aria-hidden="true" tabindex="-1"></a><span class="co"># This will print the table in your R Markdown document</span></span>
<span id="cb129-522"><a href="#cb129-522" aria-hidden="true" tabindex="-1"></a>styled_table</span>
<span id="cb129-523"><a href="#cb129-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-524"><a href="#cb129-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-525"><a href="#cb129-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-526"><a href="#cb129-526" aria-hidden="true" tabindex="-1"></a><span class="fu">## Save the whole analysis in Rdata file</span></span>
<span id="cb129-527"><a href="#cb129-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-530"><a href="#cb129-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-531"><a href="#cb129-531" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: save the data</span></span>
<span id="cb129-532"><a href="#cb129-532" aria-hidden="true" tabindex="-1"></a><span class="co">#save.image(file = "facs_data_with_plots_stats.Rdata")</span></span>
<span id="cb129-533"><a href="#cb129-533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-534"><a href="#cb129-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-537"><a href="#cb129-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-538"><a href="#cb129-538" aria-hidden="true" tabindex="-1"></a><span class="co">#renv::snapshot()</span></span>
<span id="cb129-539"><a href="#cb129-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>